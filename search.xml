<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>BZOJ 题单</title>
    <url>/2020/10/28/BZOJ-%E9%A2%98%E5%8D%95/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">输入密码以查看文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="d7124c17eb378a7fe53dd72690adae637f904509a79924ba234c60aeb1befdeb">3e9fc2ffa3f2467f30f33c1046942171d82b355ebf8db6e6ede4ccd02903f5e664603ffe19a8ff5949f1cfd00e53322bfd3045a67aef63f2f6f90d8bc42c61bfb424ecdf491202b7048a233ea9948b4c621811972937d4efb9c41250965c0e7eb8b21abe18d89b2427fe6ac33e032877d27e8a37947ba7b841ea9bea856d84b5dd5168d65dab92d258d8de4ca223dbe3995a7c4df5f1cc3f8b3dd97862a1ada7f4250ac5cc28a4390b12554fd1aafd070ae533a7648294a2c306ee7a8e06687489dd2cda59bfa236c97adc5eb2d16eb56542d10215e093a09b21ca8a7391425aed9ea0c10d2ff82b0534ed4e08c0ae21a0ff04ed5b7c63fa131821f8f9ebfa678ff7e27d6b7cbf5159ad00b3df0cae99c9643214011044cc04468ce38361ed76bd17e55317b8c44960c8b0b2a41bc79cd45a7b8497b02430d563220b0772846227bf237d78245ec60a9515d59c3bd8c2c7fc6f06b7fa31a051aa2b8a6433dfcb5152becb81d8524e85186db92e0fbd98218c85d48c4957df1e2fca9106315accb7af4fa5af6ecd6286d51bae859801880b568ab4fe42c3d2ac58c531b277c161397ba94bb86a4ee75115c1a9f0ec0ce94167b34669deaed1f1e778a7ae4a2d6cf0a3d87cd07b161a876c7d8107e3f895552647c81034fe18a74e4aaaadf7ce9f288c86bd1df6e5355979aad6d9e582bddf4e9eee169de9f093fb27f767db9f2cf07c92277894684a035ace99d70988884aa34546e9532d4f5dd9b8d63eee192459e1886e2d313804b730868b10242e2742a2084e2fcbcf1e95550b827ce78ef49b4c142f5bdb747e72ba5e4ee84db7d5d98fe5926e4ac8a9290c8625f5f429ee27a5fe73af29a5b24daaedfa37a725a9d621bd07bb02ee075605632fb9102ebd3952fe05a32f7f656e008dc004caed30f57f62c3fd06a96ff3154f18e52dcedcdd0eede868b42ecc0a3597324034f9f8f6555abddfa8dbd952ad571abe07f583d3a88f2f530dfb7c2fa26d70c485d8aee8e90b819107eca88a20ea46f0492d759be767045de4eed0c90dc451e28d06bcbd51db650ea8eacae283dcc959f5255934f6a043c2354190a2e8d95246d06ee61ba008796bf5840cf78aade0a6d7a5f40a4b890f911bdd8497665534be8473840adc3592d695ab4746f3acc81248cf90b5213c8f4f32b14ff2b3b951d13ef223abbeda25f0d80b60fcbf5774db165b4951cab3b9e4b7b87e3e4a61e2a7626ec9209bc022e5f3701cedf94eddf076ba49fc822cbb169a3535effe2ffefc8e547c9689414d52e7dc3fd87a9fdeb954de3eb220cef601d1cdb2d01661b06f6ac69e165d5fb9200ca6c8bdf8c941e79b3ba4d80a50bd5319a174726dd88696f3464d02ffb08a565abcf5e35701966713a19335c75107762ccc50db2d1a435be7af8dfddc199fb5513da53c82483143f267f8febfd45f75bbe72d260390d58103188c46397828c8f6d56295c98c1dc0962b1ae34b34cf5931db4e83b28924d5dc262de35668025032e847dbe63398ff7714c8f68e0a2b7df73d7c44fa00a8dc71dfdd550b0f8e3b2ef49107cf522c9b21c2527e34b267447719d8eeae88dca13e377f8909947e59b3d566228c9395df7f16b0a6782f37d1b95b20d579192f18512c61206675f30d72e525539739a5a9b5d8b212dc53e9333797a43d33010a1e5bd27473aed081a39dc3e4fffe0dde82ed2aa6928fbc1791af4b2ba3e452c50e44dac5883315f1858cd3e6f61415178851310d628fb67b2f25b322eeba94f9b0b7eebc8b7bf8882e5b08162c5a4fe95bf2fbeb50a80fc95faac1ab69372edb5295f48c10ada59afd5aa3ccdfebeae4896040969b9ede9c47bef54e70a5c26b8965f154d6711aeaa02b7bdde5cced79615f85ae85b012b02427be89608623750f93edd1f39c69bc32e11b496bbf68a0470ec896f011f7b922d0c51f6fc58266dfa096d405d31ebd1c24f62ed8f1e356b053c17c1ddb448f4ddc8fac1d593befd585765cd4408600d0f6b422312eeaaafff2ad96d206a80e271b2a0cd8815e5d1b3b61f86f687b3c0676a3770d68d04ddb641783a9afa21b93db262975982cddc6fd618e887b34e43f437f84c1ed84387b8a665f190c1814eff8fd0db388de5151c0087d600def135780a2b487186e2d42f55be5f399e78f0287fc73b24db5acd2ded81f5596008663a11dd31da9f563520ddc57898850638f3647efd98370b11dc8e3b27be3f85e07719a156fe8c4a2650298386cc061d96813cfc8d0aed11a5bf7f403c27b024754e71b14c6efd5362810c6a964bd4d7f36c413770359f9383f868b3e7cc1a18296de00da795ffb6a9044c4fc86da26ca0b3ef68b13ab08088b6fd5aba11134d7d248a535e918cbd4cf2208e99340ecdea3f07ff11f257235d371240ce9eef505460b66b90405fdce789b24761f96dad408019d1331f4733e7d406e4de515cfac40fb6555c8c458c968c18e2a566093a88e9cc3ac6eb5de3e9c6dd3354de8f96b02ea68d68f4ff3e96ea2ac97bb0f34f43014faf70c7316f0c62add7c0e0c39896b6fb289e94ba279982aa79108793ad558a0b3df2e83ec3b80106237b6e01c61adfa73bc6b4fadc0d73539398466993a43e5d3913523335d6a5e6e475fbbecd2da6adadffce1b90b84673f491b0ec19eeea23f4967acbe1cf74284762a5e6dbc75dce4cead9542a767ac40adbf06f80ac93f3915bf4815e7436dfb4fa2508cfbb9a6e0bd60d80738fd718fe1f192b41c1cf8bbd23eba223ce99dde6a125caa48c71e82c22476c0590e4ff0f6b6a20d925fc0c8a2725ae680235c36dc986ed2805d5b34000ab073303bd7c52987b99e13a003be537610b8e709604fa643d4a12b7fa68b5e8677cf808016a137cb95df78205a2854a693178b2519d4c8f510e721e401b1ced655d5ec9e9401ec1763dbcf3c78e3182db3c0a86b23898f9f3118997abc4f540fa94d3d1220a5e3f2365430ff6211decaba94b696bbbdbe1d1bb45a2bd540e1fb83fd05956e80860384c82535341bd010a65b84cb0e3c2aa6c9afa32c61a124f8d3e44f882c8ea2417b560c79a77a9c341159603df62058bab26e28a8527ec05ce931b2aaa2b1a903a6a0817ab48f077d2e84d1d3475c570d303ff3555235629391242bcfece498ae59b9b73d2cf23b8ef582f6ebd3907dabc631a89fd61ad034b002ec57562f6a0792bcb6bcb9f16b7e2bba7e29f600c5db90d6c8061c175f891ddc8609daab36e5d6fb09d6f9113bf46f78dd6d6429225081dcfe42d814e1e8fde9c06b44eb0076c2c7cad8e958d2c6877dbd1e4f6d7d4dae928fee0fd25a20d44a1fd7a50f9dd59ac055669037571f4033c4b50ccfe2feb71c575a6460858d7fcae0d036fa8b1d0a9f59e5f0db5ac67149cef93ffb7c6b042b2a0bd84afc67232bef423f83b01b6b5e87fb1b721aa082c921e666e800e3a6f949de3ba6374746c5c4fe3d306c22a395a6b3be2d3fb05837a7b16fa2adb4f99339dc2aef0bb829a118bc89e7e8aea0c023a2c3e7e8210ced74b71841cca754794f29dafcd8c4a1834e0fa65340cb82e63c676879ca96f949004c9fab2f43b6d0f96f0dc67a3d4af5abaee0004e903462d07fb218b9eef43442eab0ef602a956fb97cbeae015f45c57b8eb08cc77bbf391defed1fc4799903c482654e5ca92695138a9e2d0a90a10a6ceec30f95263e398f630f782e4a6d87c8c687c6592a9f165c03a370a4fc2abc4de87036a22d427cdaebc611a2837cd18d8bb478d5cdba49a19bdf31aaf45839508babb5cc090de3e35deb864bdef450353eb5b9eddcb649f0c4745bc93f308048ea644ca945320fcc00bd9323af1726ec81e08f6f1d3ae8c06a32ce28ce579b2343423bbbba9b20b42dc6a4947f29c10ab7004fb629df7a2cc9d3916df77ca19fc327d72bfb4f51ce302cd49b796e659a3dfef5d6e8b3d814752f69a805ff9a593074d847a7eaf328b1fb12fa238591de6e336c3955f582e718158c6525eb343be61665048ca65e7a11cc960c4578b6acad5cedfc52e7c8e370a356bf1b5a7c5316723373426e39915ef20b7cea8d89bbb0d5d7ac796d5144606dd747b3deca363ed3da7d58b1c8ea142246b2934ddb1300abdb8aae46438434b153c9fc5ead4b630f8c4f83669842a09e6a49fde64b34c7daf0549607a29f892aea913bb38630de826f0099aab65451a7b36bcedcf9a053d1e41ce9ced891107559f2a922a5c18c11d362ab15ffcfee6a517282a8285dddef6092f71ae526aa43000c39f421e1cd867ec6df2c501983a252c0d34fe382ca4de039cfe453b2b580881bb10ee3cedf995d3c8b3cbad7013f09d7918a334da3ef1554a98c2e951255d9b22c8a12709c0d6ea92211ff30441882dc378a3bf1a031933c5ee0ea5da38d4f32a7cf65302ab101c9473903076a2d216e4dd7ca0804bfccf55c1bcd6f30254593156e2980d08e3c28a2f51fd6b650bcd17a88f48d6da88ae93723c0eb7780ebf4456f1e6d6805b83cb47263062025f74d93651a7ef17a61a55c889829c6946d98a31ef9ff7f2450c1a83a7d45ad65fa026425501960e52969754689e0f27ac725129bcc70b6b43a838cee3f12b23f000c71f86844923fe9bd49b3a9957a2e5b222e6b1b67a69b2591eb912eb018b1df9fe76a0dae1f84c4b05b5ab08ed0f9c2cd7311280a8e8eeca12b69dcd7e2548becd3a7fbe7e6a8de9cf8e6cb0b3009f099e993b69b38e719cb977be4ae6d15d0a84002090bcb04541a66f09fe264b5336e12a56c9e88b0592665bbc6b52e8e214eaf749c02c0e58531b90cd45d40f14c784b57dc55d71430264669f60670563423ceb34df8e0eccf13520003e35d1e425c0e3f5647a5d5c0fb2f35785ab9b37ff3d9aa191808717f83b0e84c0f47246b04e2e4dcfaa02fca5d830c2c621730faf5ed01f381b124384ba6e4e43b6cca4074f5faab30b35fa00d9c019539982affee94625a9143ade8224bc16a6fd3df7fbdfc9e5ebf3099c728255b5280445ce3fb908e75f362cf8158ef954474101255a54b8202330861740263e9dc944fd6c573a160ceba34bf73f24c18591345672b854b97039333173cd67bbf785c814866937813abc381bb0f6b9b6e5b684f744f584701b7b6a9e72dc623f65dafbf2bddf164e02bf0bbf057c8079a49a0d4519708af9f7919be5c395caec9e9637f2d7352e98aa7c9c3da5ea67cd5ee59e3c3898e2f6b1b247eac9a6c11a02eac26ef32f8c7658ec7a4935f96cd0ce1e0c0ca9c92940624ec724efa4f61ec135851b2e0de1fe707197f64980e3a1c76dcef23ce0773ebeb863ae2e752c812b326df7b1537c7ed0e4066e7b04443050b4e5c7e55643825806a9f34897bd57b7be705548b966e8f86541129e025a76858ca367fea8206e36e0476b377e73fedc52783196aeb73e5af0d8003981f638237ec723a160db5dfad5d358fc8c4fc57598827beb0453e403fbfc0c90be031372d8c78b1a4df2f37e1eb6bcadd471db991736e282b605f96bb44f3046de80414eda41616f7547b1cc9b90d8047ea6993427aca61c1765bcd52cd26380620a2a0da984687fcc65ab620dd2cf65faad6b22181226d06c3742768561d0edf0b913e6c3ba17b0b534ca86770108cca4ef2c3b3637e5186c87f79609baca1ee808eef421069974a3a89233ca34c3401d21eccdc5ca18cbcb1ba720a620a602444b7ae6ebe2ba2b3f5e718d2cf1f3a3510a50c6917ff480033a1ac2ba0d0ab90f38570d38e3d2858869325d9f999d1df27be517446a84ae0d795548c875d99f9287c11d4b27b1a2ba2bf463012091ca9e5e69971e94702b01f8f1b6f928e51eaa4d001f1135f53b0a2d5df04940d118e727e92a3d3d0b9a655683d3725d5434892bd45c6a5b481098bbc68be9ea9bcb51df4b7177d48627bbbc08ce8cdde65cca41fc8bcdf4708fc2842ac68fb64a5b98a8d4532d295e5c2226977c2f9742887947610a239b6fc2a423bcc6709cc573a3b49f4c55822865a12ef648753fdd24e2a4e1a860c4f9b5c38889898114859a3f4090b714445c4260fca091120dcc46ddc55bd9b519b1ccd2b852ef7fb6741eea588619f99ac52ebcbf57d4eef08c9681faded9fcf1bef23b52cd927b987536001edff7129aa39222a22abcaae579df3f6a8473f0629eb4d85c8ad61f02fdf52c4bf86d10057498a57634915408a30b3b9cb4be578fae547a8fc34ebad490fb166fe8f2c4c936123290bdba1b7421df69aa19ed2b7a7ed7e95002f3d64752d91c8d060e2e281f0aea501e7325366309cce376120732ad41d5ca97b240bd60391686b00c8f7da6288a2225fc7416b4b43870824a158069c5e13f40ab15427695467478be137d38a2d7e6b005bc741e25056867a21cebbe8bd8420845c09f040307d172117f191e44c008a0ac22a15cef260f5b77f9ebfafa1a55344e723f9a0f055e0be35ca794adc5aafdff531eb6b6ae77ce79315cfff4730fa06850a855e6505ddbc66fbcd6afb5047b1aa4c98fe48cb7235483f21cc74614cafbc403ed3079506a2a6ff057bec53cf84bbf9517d975b65f0e343f2cacc2328393064693195d42e6b0d4fe3a40bde8fd64d4b325ed2506456765fe1ae97f4cb820c7aef267eb7256307c2d30df9f9ff4bb7ba71323c215abd82f11e8f3dd3e9f936efab792d354bbc8a9d872e75d7c63c96b55e19e558108f75db8ee86967ea787a100b2f9ed85920ea9359458d17d9f2c05dc9cf5eb76f661c0dd90031f17deb130a01610158874baebc9e756803e04c1594aa71df6aba1e7f9fb99aacbba2edae212eb210f03c534197e960c76853dcb0bd725cfcfc1db56266697536013542d5addf6c44d99ddc583ec017a503c5edd6333ae0f16e3b067a6317f13d854ac68eb37b3aba10dd65e95cc3f84d8948be7f22f0032bf16fe94b0ecda7b6d72fbeff13efde561e3e5b10fa0ab6a2d8eb4a37f8264fdf2da4b86f850cfa32a728386cd803fe5a1cc403cf330a7e40c9b2cf532218b736b402994e4ad5f0d5cc97efa4341105eb73619a9f63aaddcc511549dafdd923765479a1b3c890f94f1c214933979bdfec49ea3a50cd1ee20f86aa3385ce85de3b9925cd89bda042fcd93ea6dc59052e07ef8a88229f0aded48f4553fc640a95e2e7469047f542a2da458ff65c521f15f34cb4d3cb70b235f7bcc28608fe71d982428faf32d414e318e185845bf6a3a3c5e73e9818683ae7d05a38f41d7923b3e53e2e5555f751ffcdc6708f879d6dfed50bfafd2c5ed7de3bb7dd44206f4d5bde555dd86843d1440704fe58a22df6e2df653f32f1c7fb6aaea2d8faa46314fc11090decf2b68fd5aad505aec20901d196318ae646b69cc8715bcae9020fa57082674e4111a96d51326dfdf7fe2ee16f1c19cf16df938553a41eb063d54ca9c38a711afaa223d2c5805b8b445d13dcd5f545da98a9736c565d2f1a51900d986ec1a8f226c4b17e304daa70664000eeebfbebcb28a2ac1aff49304bac467360f4b367231e42f19f22750aa0ba86ae6cfd6c1cf2ceb6001179e94be04b49782055911b1d551841d26b3e0067475012ef94640c181bb9f03c52ec24eb53e294fb15887a2c238a95cf0b3df376add0490be6245c4e2dd2baf413bcbba4a336331104d94b7ec0e19dfb03b77750d3017b4f87710de4b693147e60b55cc36c6d700177599cd9a723d09c7e6275b7b80de46bb45618400e42d31c3d2bd28f638435cdc28d83cbdb1f5c924c6619a4d36438db1d9191cfb15dbcb887393d4f31840460ff3d547beae222f65eeafa3d0cb3c80e6202371523d85487c99a0fef3b066beb7b3316783510f4e0ee9b8cd2eec575dccf7cf89b9e09733a24987369882aeb2ba72dedfe5dd339523d40f8d8485cdd77ee6c4c41bdecba517a5a865b2d270932823bef2493f64944783441014045bbf2699d82c0b8f71e978c1fdfc069505fddefce28b63ec5b5c6e000c569da2e1b6323ad8c032f438e552afd2770d60f80707dcb04dfae90e77723b24edb749d5d75e23762e953399b78a7768078d9767a00180f42e1cac7f5e05afc2058c2119656073688ae9b831d8b2723e3e0dd8c6a0b2468f3f080c8f1101d6f1e2951de117c9f9f90f7e8a0259224dd1bda8c7a322af2d2a5e9486ad8a8c434ec72ae19271f0edb194d1a55eecf5c18b8b8e3b5b33e38c4e28eeb0ae16fdcee5c8c3540d0090999b8c1722aa7b2c1c90e7b5139f64d80b53e9f41ae3c104e287d426b6b8fe62339c206245a97d19924b27d4e2035b28f5c8a67c0f96170b945d453f16e4e8b09f4ea972413bb7ed724a6b2a4d4fef344a4029d9e6ce2eabbd5a8923f6cc2506acffc85a0df3d9e2b14070578742ff5f259294c80365a456c9fadf25bcde4d6af9fc125e727b48514722983767364de13f3c84ad247a7968ca6a7f4b93ee3b9d0ac0765504b8bde1a19e258f75d40eae1c4c3d8d8d6521ffbd59c3e77c2536bacf04ddc9539a73da7215c78333f88d95776d103a279af3ee44caf3f8c92502a867b3b81955313408871e8085afc9d29a915cf06781035ecdbc586449a6011d4fbb2c2c9cb575fea77f39538f87c9d8cbe20862b0d1163e00aeaedae9466e942e2ba94ff52e52ce21a55ca37d1576d6718cba03d062941e42a41c568723d3cd7a0c17f6aa1c0ae7988cea8ff37ad8ae432f35fd836354aac13c993ae6be827546d3a1c32fe5c1a80379ecad8d84221610a3f932c16d6d23a3872c48e1094eaab90fc0da56a8a29b32500046813f0c720047ac1a711b7d3454ee88517f1e169b6191c23d2a7c7825e8b5cd1d46e77969c45d6f3311722fb6112d1f581c8d795d88306a022eee0ff6bd444e33f226ea2bbec3fffb93c80200f835b94b3b9b9a91d5adb7e4f4e392eb24b5c2fcf2715ca79dc12a91f1cbe82d4edc08e1093c2791af7d384b294d0624e4f07c6cc858d5e7ec590120d1b263c28f102d6994ad522044e7c109d6e9506f5abae33419c21747332fd31e126012b8cf5a3f96a7e1394ddf112394bae204f0144ee80645533bd26f34dbb2a43a57d51f720d25d372080585476bd62d6ad982d5b6ebdbb739feddac0202e97578b733a023f74d81ce8315c0973f3eea0c9ff7250a33d8b2cf0b258a8063e5b1dbdac44cee9dad33a265bc3ce8decb4400c8883768fd13eab9cf558006647e22c9c529f33346e32f86c0f0ff80d72ab872fb85e591caa3be02f4ceb7f50f4305d4fb06a5fe0b27b0df0e927ca91bcb7a35bfa955dd0bcf77e35d7e87cca942736d63f0a22e5e65a9f11925dd0def3fa1daa1f7412ed482b26f6a02dcd31051bba14e22bd7dc905488bad2cb662224eade7bbe15a295284b99d321e032eb3d54788f831c935929a1d8b3f39481995563dd72c22e550c7849dc71a007283834a31d685efa4e6c32a535e5f7412495d7e5b0102d8829ee7b397a7119aa4789a49b1e48489094e440a9c2a61d2035cdd708158bc9e1be0ae10ba9961d708c6a8f35b0481d91a6aee95262c6bbfc59eab59e6d46b45513468e7ae304eaadc5767bf281b8b32da544d7cd610b9ff0082e6215105a24f9ce70e2d2fa6d81c17b638ae8e8fd707b8d8ac694f5ff70cf8f72ff7ea73da9367a03552fbed0d1f2956a7dfeb5b783787e2732d305727be7fecc08dfd4e95a278edc36870ddfddcf46c046c6676dc982d69fb3eb1983f2af6b78974ed7692c0cd72c78de69e1ecc23a3833e1f92c07da1f33ce0def3a6a56874d148ff44130cb8d7fd24d752a9d354438a63671030cf0681ec0ef210661c0df085c8e5ab3d653c3543e93ec982a6c599cb764e2eeed9d869aa1ad73fde15ad0bd01dd444e40a1dee15a64c093e963bd2b76ae90deffadf471dd68c948cdb509b55027fda846c8006349d5f8c3792cd3b1dbd4be34d894bd8255d14a90477916903a8a1fedbe88996668186d23fe269a0105be77a4978f4f6839b1354c18038d6b962280d579efb5d508982f19430d0a5ac5f591fb0639ca982487b65830c6131a975e4938289848644303861a92415eff49529cb83b04d906b43e424357e5b17a379eabb6be848f47998b3849ce605455cabeaf278b96a8b55b91ca7d3532b67a55a5f2cc4de225e80a7032a8cfdc88ac1bd452ce9bc2db51a4d9e7b78b7c9da92298ccc57e1c480f663e6478b503619895b42593eb83323244a7fff6c31e91c17300680f7d732d200773680454a07b819c04fa2f48ee369428aacff67c2251c64b5926f8491e525eb19e68588f0e1c83012ff0b9143072ceba2db71992738cab0c8c967a3981f5fbd707e2097ea51791b2de3adb785b5a00ca5c25bd7cf08f8cb6c3e14e1b6cda766e6711ba5551c5fb2e5724f8df4fbaf910a2ed3d87c3348ba6a51b8aa3aa60851479e52744a4ed44f063694e83905604d99e379abeeaff683e8247a3c75b3415a153b3d7b888fb548d932428e85f70190990345b1dab9c6cdc1771c31fd15ca226d081a0e5c9456194f4f70a94a7f11811c9a65a05c06f520167cdd38a86c3a16213b79d357d835f8c50cc0a13048ab3d10f501cd9148643a9e7e5054033fedf171d92b78a3e0d1e6da3553c770ca8952b7f25905b45fa3862a7fc8e6307f756f171a7304b83d1f550382988f05d45636e2b9d65c4601a5cdbfa5034e6015688c232bb6aa33fb57a3c42880609a770d7ee5de1d5ca02c7b260994062aff4335e44f36fea561e001f15c5e07815e91e8521bb7387d30733c1669d7c8ffe288869fc7f6b00a5233559658ca50c216ef0006c58e174db119546fcedf849303d87c31b3ecf38ef48d833120f10f92450e06f3f1be776ec4b9bd708d00917626a49e0d22c38c3e3266ce31a0dfab43474b1f741aeed05a6765b6d13518b7469d762d199ba7d69d98e1f2c3924287ce75f26e3eb7bab1ba61349afad3e840f71a611f7638cfe7fdd1572008bc65ce9c976e92281d4f5b8c19794305d15120e2bae6fb809191d2d53fa177f9f3a0c213bfbc99ac42365d631f5e779e97b4137a15c6464d9fef43e9989d76cd68c16c46f8a059e333651acabb6753e48ded08fd6596905a934859f4a513e837bc8a46f148fff71964142eb1242865fe0edfbd254bf3b8d98075599820ff8b0763cf1f1561eef6a42d2550f870f5041f6a4d1285e6d3dbe9cd4d75ef3a2399203216e35df6591a1ca4208415b2929b7773e98e6b9ef01e892635db8f9c2af7339a55210bbbee78cf14c5cabaecb262b64cb6e36bde174dec98d3e61cdbb60567dae6f2aca64a71960d344f2ea2d0b4f37433b537219289e5a5ef093f1c8f52badace7962379d70024a0e41636296ff764f3e7de14ec3cceec83bb54da24cbc4311aaa932718a54bc9e2d8be806ed42e6cf7a383dd107d732302fc775a99705b18ac2127e60d90b2ee70f96567a6896415d5218e8ec021aa2952f1c55fbcefa66c86451f6a1adee68aed2ffab5554f40afe9669171bd606a6ffa8ba888f04643ce18fab30343eeac54b726eb870375acb72e002e89edc96e488f7425026b8867cda175ede04a375c978197d43e7940c89e13c8293c936d2046f23fe8bbae5351f552fb812733f0f47c395dfaa7cd5d667d0662d3dfaaf2b90398d60691ab5a6e91e54f5f11e05f6ec12dd874f7836994fc935b67bc244e4ed148573bb5330fc774e923180a07747801874c512954c3eaa748278d1f702826614c3fc8b2571f1401b81e97957d14cb8bcb4db22696190927470ac28db9a726970c22fdcbb67e55750a7b73447f698f2b59dfa2dd43483635f9fb6121cfbbfee406ade354668941eb836002f0244cd8816873945b70b947d13eb489dc1ee4137b7ea3fe9b32a711c2f6f4e2da3e033857a7b5234eea87e5a412264efa2a2b90afccff11c633c35d731885a635ba46521b3ec7c73c09059dbfe5c190b547ac6bd16c01e6ba7f2684c8d3201561d96ba4877488786cc94599df2e727a958921cbf31b2ab8291098919d24a87d056d77c95ed50dc04197ab90b82a95b0b9540c8570ef5099a4c7116cabacc80bf97ffd89aa045e6a3e21fd434f5513200cce8abb1cb144f3d2281581fd5d11bb2765e6e402029f140de1126daaeb9a7a21b52f4dcd3edc8043086aff2bd599c36c2ab4503ba9ca975dd64702272b8a2671c4b6c6685b0732b91e4b9d0e40512c7fa7dc8bfc9693c57017393a417ce86af72b3425c758f24100c3ea6e963ba973e906cf9903789926426906fc261136544114b43cef2868ea3f242acf40756965e7da0c6d3082532e7019b9cfada40600307483117d717f0af98f20813600cbacc68c9479e608cc6b3c72c8cacfb1c01dda374afdb993c2dbf5f00cdbd259f7f5863aa65ee52b965035dd0cb0d0cb0155e421850d3aea9768591f28dabb6fbf97837d24b6ba3dbfe88030f6f14f67e62089fa95fad49ae198602cd32a3ba5ba5cd9f333f602b21fa5d746f090a21c65f990c4225f9ee3d052b42ad912cea6b8bed8e818a69630672a74556d3081b5957dc6c99c1b0a461ecda02751fa5869c43757895b45bc6faf4e895314c3ea5e24cb3c22aeb598239d1f50c8569b94a757b9d4148e7c0674104edc2139e97c33ddc8db38fc35636a3186836902c2f0dee3b70f6af61ccddfb7d7ecf5c83068e02080c4299ee7b3a476b39163c102d6be0d93650b7fe30990d906d0ab949667f57ac800323b90a775232691923eb381b854a0079e2c05eb680658b6a266373695d67cae0ee522618fc9c751565b1b1e421fca61978e61f268300dcfb3a4a263d8fff65597a4c4d31b0704f26bb7b324421b104156eb58a6cbc4f09bf45b76aa0331415f3b0899875e35fcf97a3ca64255a96ca20c41299d1178f438c46efb5877c857924b97e2cdb246a2c9d16cba10a2b32ce374b281ce2075876000416b8b097af02e715a1e908b01df369edbbf696052101165d7d18f33927e14f161cf75f17aa8a6e44cf7946c1840941deff11cb0ff17abbe07ee831d82a498e8f57981d3003c74c7d51a0414d4881e2a1461898ed84b28dad04641fcdab562aa60d170d98f969688614e246936d2a44dc1961b12f924845539e6d64dc22acecdaf3ad7d44f4dad60ef78f14f0bc186da6030c5e700e722d4b532595739fa12a1c7e5028dec19bd07e3e31528436be4db458d6cd858433255dc0b2674663588e3478d5223a04915a078c8975717efca3e8c2e39b50f0bfbb45e3e7eac00b09fe17759541b004c94c4c278246e7432beb5823259e88e92f7f247db03cc512d900dd1dfa60097d06f6d0f8f188c37d3ecb48837ab95cb92fa452c98a9bc2865b61e0854b7b25b2692a7bbb34eddffb42284516b4bee165fae04edd930a96e7e3617646dd771c06713b0f5030ec892492c9aee9320c9ede45d2bf506583a28a36569461e0169cecb1e7c41d858ba7a080e96541c5cf8437e0255a9f96137495be5a60877cdc521144c9c81ff4f7ecbb4b92a18a5bfc1898b3d6ab31ab8235bab2405fef138f987c33d9b433e8a934acfb601941fc49b3c82ae72498759794197cdf1ce836ffeb9f2fc36eb0f538984280e67747dd5fdcb3ebe3162e5c6d5f548c0ab85060d54943af3249690636431c050385841713b110f0abdf212e4891b702171b6234373d5573044ed2e316b8a39a31b8863f48a51e3fe2122f611c644219a5cfc4ba4f8979c8e22b269aa9aef6c47125fd1a8626831804ff841e516d313773a0a2aa6c52663ff28a6bec95924df976dc167f5bc3da915fb72d174e05da7ad505f055e1920c578c3c62ea308edbcadc7683d506b5c67934c74ed2d46187d239b5b6bec3322707942fca8e94581d3ea9f75291207598eae026f82dc00c21128390501b22059eacb24715f67c4934233f1e92daacd0b075b9e4318e8ff47040f5b1194902996cce4e3ba445a065a9240efd94dbb0a8fc06abbdd0300fd0511ecab225ff791c7d4b5bbcc5bee2666942252b5381477888db09f2c68181cebe4ae75768cfb48ca597a8bfd9e77a283f53c2fc545bef8c040ffdef322b9a493b1469a8b519da8813773d35d82be4d7b114721ab82cec1b04df699f2592eb27c4ddea223ce0f17d1093f7e57348897c58cd0fe68bb57cad0615dcb9bba92457bc473d94e33b2ad40f1a80e8544d69a99f220275eba356983ea99f32e87c39117192fd85272a468f3646c6b0b5f103546f7e2af21dd0ab5dd7754e0f0dab039f2852e19c36feec169c09da7944fc27fd1e8427e6ef71739456938d38257e8557c8c060fddc08b36c8cc0f5b97711916efa21d2d25440836e6ffc3955eb887f48f6cf2a55036a74d715b732226546d17599947549489ef2844c2914224b84b7ebb5dc00ad5ff02ac356c1ec6efc855aa6eba5b37cdeb48d80b6f1410de2cf374edc3b77c84f9da48bfe15e6267c4470b590b425dba3a8a260b27ff238ab8ee9ccad573dcb2f4b4697908cbfb749a7da20354a19a49c21377240d074c77659c50134c2b2ce3da85095ea4e33c62189fa4f8209b166a2228281cff0a9186bce9feb6c026f0865d2087942acff6dae3bc069c84ae5390d714737743ad22408ebb8dfb65d14385b62ff29bca2be0e76ec864b87b2a84cb6800d785fe96be9d9025490d8fd32c2f47150b975ca87c4f61583f04a01c711f0600420a3d40a7c207332306d055953a985037cbedf2ede03465d4daa1d96fd6b57f915845114c688aebc6b1eaffae7aca4c9ea72c4309fff7287e06bfbffd55c58571d122df4257bfbfc14ce123a85b910d473d07c9b9374a33f18a3cf842ec0d650d5e5d19f51fb214ea69d4e2c26f7eda1242798881b6ec451fb9f6b3fcad1d7104170720854f6e0e8925f2ef9e0bf82655b796b2aa0693f59a7f1797b338e98f5599003054c5f4a56815d1f0056e60213fbb0a45360e243f66dc13fb32df590d890202b307e348ec12a48ef876bf190545d967deba3b70386096f376e8055367495a6793d4c89fd17f74183318ffaf72a0ce215ded47c652d5f61463bc1af819fea4bd68c7159fd7fa735d938dd3bdee18b8fdd11afa5ecfa41d9dc7847385ec70a79638ec96d62a41153255d6e04ee97cbc114fed4887d2570032ff2c248c9a30d4f8d64ccd68d026667b1ae0160d279389e6cf1871208878dbba0e81adaa4a576bf7576a01632ddd8f3c70c60ea306019f62b25b17cec7fd655df4083d6ce4bce4641d101db8710b56c93d0d5f7f41167c6f3617442c043e854a62cae3070c05b007fb65cbe9a799e51d4c42ed26e482747a7e0c55a04f8c78183244aaf875689a74ff7180fe6020b709d1506533b26d3fbd431ff8af1ddff42158bf86a4722d51f62b2dc7f825cde3269f6881be7923cf0d19714c55d5d936afd7c99bb644dbe6db66c1795206511e9b1023e3e768765a796d15f06ec5b93dd3132b4ede4ed421f67d7ae53174ee8d6f349e790ded3b9bfe1ccb3117499e34293da25a5e514735aa356f2f53ad1bdc289766904d3ffddebe70ec14eac3e6dfdc1227cf80f4f4f5d571c76fd1c4f2410c6c0d57cab13b0eebef33bb4929337d7f308bc5268b9fd0f2b0c4b7a7e6f85ae2c40c4abde98c331c7baba10b7e76acf4d3352bab16cfb2efd0ceb9912faddcc8259bb0709c0f112b6ca6233fca5f795012ef8607e3ae75e2a1b80ce9e31836dd75802d0e7e450bcb43c771532106cefdd126c8fbc2dc395c84a4921ff6167c282fc593da0ec6f1838a84b6c7243e2680d14843bbcc0cab579df3d97c201e5077253bda5a256fbddb7d507e295a9d533ecd7aac7a94ddc6cc13b82b53c48bff31fecb9201995855361e317d7cf83c944872266574e0356daabc49fa1bd0c546dfea7fedeaf7d0eb3e01ccd1e4167cf1e5a421c7a4acba0c6c7c4c14c6d0e60bca6139ca871b70ad64b10f65b5050dfacbc8193213ede863cbdf4d60bbff14f2658fdb4de217ee22fa34ad26370285970609d5a095f7b58ee3d76aea3ac704bf08888fe259c7c04dd46baa79e0caa394f1d9bd9fc0cb60bfe6d64e94b06ea8601d92484e6bd118aa8c657f34b50bbda03004e9ac6b2cd76904f768886502ce5cda126387e2464bcb37ff08bc5634d96fc92f19e37f1102b5644a4fc29bf93b1fdbddc08469586c42066c2377cdd99a694ef9c5b1e34d43e8b67ab9782b948de3c6a7c9937c2af348fd1b7598bcee07e44e0cc6b1480560644eeee4c33a8b55e9b7706607f6d2876c33756e6a554a48f5f53f574422b49d03c8bdf1eb3f47908fa068caa43163fc02a5de0b2e9d398355af0dc20a136b72affeb3501ca5209b8218a1fae03d95132332673c8c4e8159eef5797b86835ea5a02e1db405cb5b7fea1c25c6906618e708eb0b86e007925591255bc8f3a3f108f11e61bd3b36d2f9bf42e0c8b7080bf01e3f4931b6535672f43f896f668dbefb91df25c70e79ccfa6cc90e22d227554071e7e364e68f734a9c32089aa2a1045248eaf5da4ecdcbab3d9046fa5e27715652e068ca60fda781cb415182246ffa21a7fc2e0ebbb34d7241068ca4ed658f7f1460d40e95ba1dc81ff03b761f7ad80d28fa1dce8690262542df73aecdd5647e6bee6117ed9a4ee6ed3ef65d41a6289f115ebf6cd088c68cde0d2b331b65125998e24ec3f881adf46466fea12b499fdd8af2d2fc80ef3e25a08469e92577727ff4bfb48906c9688d980fd0a0debd7902428c6eb27c2e1cffe2cc07af356eacdabe13dd4be57674c0618d09ba8cbc82fc245ee0b865126e8ff056d2286479f430db1c5aee963b326d1b6134af02b6f62baa2541bb674cef640f9409d5dca42af86b5678f8452ac4c5b0b138c74d801e3763e72140487cb98adb244d78b53f140bae16902c29645e7132488ac899c7180f61227f6051a275c62ad796c6df262098fbaf493f365cbc8a05aa6f68123c177fe099f90040d9d63f01b53a7fbb876905fd12e5abf50f807e3e3009136bde6511f2d2c0d81eee439de5c918ccd7df7ec1f16e7b6ace259dca6d973680a72b4039428d5c58b00d24aca3d9a8a324a72e0afa8c31c240692507171eb5dde903d23aba453fd9284fa3b68d083a5d878ebe86b34106d5beb32fa9bf2bd30f8044fad7775573272517e009e0da35a961a9b4ad1dd60ca0c0a3c29c4f047708fc8ca309b49f6adf6f589ec41315318a94c9760cc74e7bd948d6c0e22b7674185f73c3663978dfde5e8083d9cc3923c34093619f0a021a85f437d4fee0e645cb161ca5761234c20de091f051408617563d27d54bd3cc202c3f58263216aab8b726256847f306f295ef789f91b1107af4c886a7284f1b2f9e3a54664ca071d2ff52d30545235860fb21204116b22d1a9d3960869f904e282dc79e9075503f991f58dbe52045db724d5ba7a88a48a0bf9f0e86f61e38b5fdbd4e8ae73c67778a3fd3153ed23a6b9e73ab81042190322d3000a10993059ae106939379dbb3a9d1a02a04022e209de308aafea43acfc8e49f47777ccb77aef893a06ac1df559ab628b6a03bfca6df878a72a354d91518844639775da6e1d1f484fe30291069afb7214177a1d4baf731d2705a81923fbc0fdad2b1cc2bf7ad2c94ffaaa43e2456ab513dcd93863b803740caee83a998a87745789e1ed3987d77d92e64c401554793d63dc4748e5a70e44c2f020944bfe620e6af0bff5b3ec81c5d5fd0a1f22f4e471d1e82503b2d416a6a0d8ecacadc62f08ac5add872d76ccb8dfc963917e15a0179cb5d9c0aa4f39339660f69a279bee76fb45910398518f4f6b2a410e1d7dfa737dec508c06470459951d4081033aa01b46b90b0b9614f63278a5df9e5c006c6072f47b48830db295a73a847e1b9f0ccf725fd85c0cf9db38b821604730347e0cb7403fe9b6c1696e0843ac3fa96e17466500718c1db0716bc261c964cff6500b53601ea952719048efb75ce7bcef1b0368db2175d01cf3e0b0fcdba844475a195bc801dbb4ea9d55c708d9e2fe615ed38b3d04732a7a4ac06d0d2d80aedb701367a2648a424125b94bc2d9412530cc9d15672016cf874e50e0bd5c8db41bce515451d8ee2ee1425685b1b1fcd6327c69c1d791779853442fa5c47b727ac5582528beddbbdc4543ef83b8466136a7da9a3d01b2d369739b28588814314729de9292b5bbe8abd35c82e5211f22a5e3bf867c9fd88294f1b182258cc376d2a5ffd72411741ef03f76942d27073046703700b6c09fc337d5282517edc8555e2dc1d539005be70efc3aae684300ddd82c0297418beacb19dfd53ab0c13acd9706fbe3f25aded523a93c0cd99aa9baf04c83d64544ddf2449d77d4871b1268f5555d81282469777c7cc66b761a8436f6baa3f0c5dcf97df1ba7a5f14956fb14f193c646bd66ac5c0a7075414b5ee36a7eed8aa060514568824f6229cf76c504675533e5cd1ed6bc6a5c2a3a80209bc74aea18f20054b748b3d4b48e263ae6cce0bcf67e492b879eea975d86c405fece9670478702c4d4d70914124366bea81a118d9313990791d81d84bf3c67be0ce85eea7ed43dff83715a8b87d1c3fcf22c42f272e0e889607843e477d19c7c7d338692de17e5ed6dac453936519b976647cfc8ee9d9429c6342b45b2e5f6298011190789de1b16e7bebe477fa180a8fa65dbef8962e1232216bed07fbd968e6d4c317d175fac38038c6e6959c48af0c607fa7ca88becf0f2e7fb9e890d54fd3436d995901bfef50c214ea304a0c2d401addfaabc319ae911ff9e8ada8d0977b1d4b2f87492575b230b6490899b1b88a76953afa9e5b79b21e6f5a27b7c3ca0929e994fe63f82548cd0762cb4735cd89bc2ba1dfd741be83980b45e6f9df4913b0b85becde5a4f676fb6acacea0d0207084ee0b5a9ac13011b128846f80944f032012251550f5a9a3a21f83232a3cce8ff5c1e1f64ce9825a272ffc990a0ad15fc16742180f39e1174190683598bb97870483db30290dc177de306dc12c6b964da8f5946a67fd129eaa812c3f6aab1866135845e3712fffc8aaaf38a6f5f29e255e0e21dc4ec414fec0f49cb79b3d56d3aff9ffe9101a03015325fcbbd07ae3d8ce2b06f225e3f999021583f1eaf8a353b210679b32a49e02dec0d532213981bfbad1a9033a71d385cab2d24ff0bc992f019980908ba963c1d016b1dfbde3a7c3e15ec449ed3c074a1f51481e3942a2030b4ecce220e7deb05ed2fa0ca3d491c1c65b4516e290e488d68dd39d19b3390598b096192dd66085a1341537a6ee1a8b21289d716dc8da977fa13f8d8109462c62003987a7b6adb1a9aa070bd8e95167648751ed816aaa890e1cc107c8abaedbda113e2bcbfd8de060f90e53497a76bf0485a2debeecc1b0718937e9f9143d9a836ad1ab1b25c0220c9bb7ec214a8425ce9366aa3c95e13035b4717462913dfc3e68b1a4730128322333536ede1b5a1cccade972d3c0f53cc8acce94bd956fe906982fc3a18923023b2a6cf61e2cf825f774561f7fc00894504784d7b2b2ad641107b786614e2a61918589a3db3108d9f2a96a812b2d2674bee5cad40c9ef4a8b5fc9e9c5c9c23a7642988eccaf95f98ce891e1c589e46a33bf6c7b86544c62445e349feed497c4abcbb4e0e82a5de9fe502a5e057362bbd8e5964bd182cb7fb3e043283ff4dd32db681bb1337870492ff42d0d034d0d8c998be1f976576f1d44b1c30a2ed0841bc48e4ebb19b176bb2f802df25c906df476d461b6d1fa615b8ede408b5e4d7bc6bd35bf0691d4ea848b648240971b9557c56984bea698dd34045a3691ba4dc9cf1a576f5764c079ca2bf9fd699b22a10a17c2f92c6e7ec7465d1f41fcf7aaffb82a8cd3b3bf2a5268af60b687749287ddb2fed9ceaf299ce6945847d752164a9b677708c34b66bd521482718d1b229e9f0540cf52d4764d0eb08e2213b28f83e611671be4186014323dd70c4dde7c6c445a780547caaf2ef288c44f3727e11f7d7f89bfdd4006ad9bf923f6d5a9fbebc0d3bca36157987224cc444090da24791da1d453ad38c5175c590766d88966b5e25c36a620e9d8fffb8085c1906e9f291d643b6f7d5f76eb537eee791d4b824444d7f2a67a71fdfe44b684bb0a9bc820ccfc329421d709547f81ae8f7e50ad0c5d79186ae6d362dcde2ce45913f010267eb489788ab26bcc1dcd0026ff24552935eae45751e51d7cdd6e7f5666295ea6c7be5ca39d2cb9f3f9a8b4632c3329bddcc36d3c3b12f5496005bb46b5cbee4773ee721e506d9db5cc7acb05bc5a962f6f5ad16551ccc81b64842bfb8f7f19d8e23a8b625cac36ec55aa653e364d2c2bef214f5a63eb34cfdf74cbb27aaa2ebf91343d6288719f5775aec9483b26278a4f4a0195ac17c1ddf622ebc9ea136360de4d5ccdb6edfeae5ef7b3c1d271a5c1fe1709066ac5227a2e55fcff807c1df7ae63a8548062b655830c94823137e9285c4ba685eab5d401f06e16908ac3ed28085b6bfb037d7df6b01f504d076c81d7309cb6cc036d848ca4fba4487b9bbb0ba121be8b005dcfd4a096ca348eabc20af249d5dc2ab1c577b9764a166b28fc6551ba3dd86e93c428b136eb57e78768ede7405258aae86cb73958542842e0ae28b7062eb029700ba683df59455cdb6ac0369ecddc220702078a3455c5456e9ecc20060072ac147c624479eb942c2598a610024dd38359c98b58e3058faf024dff1a27002ec2ee8403d1483f1411f534eee4d894d8872b3d2c42357d6f9fd14b208477195054430f082da8dfc4f880e1885f083383a4a7f7ee4d606fb5caf3512dda088849f6092d64bdff75d619b4362f427effc5f6b5fd03a2dd1dcf16d33e0f05d19d28ee9fbbe50a730ec29f1a1f2fcc4926b2e4c43deb3ab2a1305d69bc115b630ec03f67f1fd89130d6b2e360799e4000429bced3d4d496c2986d14fecdf60a66558915b0ad64664c69d5eeb5d90d23775ca3f8cdb720d039247e77c5ad3ed80244dd2882262d6a6b89df066d521b01887aedfe80ace296ef1fc117499984001a346ab28fefc158cc331505a31667c15a318110eedc8a4326b0a531c632f5ad9020c6e1be8e03dbeb2869ff3c4fd3ef4da3036a19890ca53eac4ed9c5085c684fbc4e2be4d12b7c7f835f062908b74ed9a68a4a1578399ab94bd6cafac94275fedd96abfbe0a3ccf3484129c8a858fa3facf8d0e8edd29b39ce18b6233eabe93f00c0f345e5d29729ab19bcde88def8b774ccd1fa207543cc52038241003b5a4c3c9e2b750ad13b4a877aea69d92adf20bdd4b8c2f168efd1397cb3a214f6ec633c87b1f7c33e37d76fd3056143705a371b03bda62716a18e6fed20345de2b471eb58aec5c7d1a4b89adc3188851ccf82027b2ca0765f8084df644433b02e0d44d180fc2e269e4b446d13e1415d2d646ec692db9c39ad736b09139b84eb0718412256e65e08c1b19328e099e7a15f4345a096a3831de3e9174e42318773185292ad9d9cc7abac3699510ca798d712a85134967c76bdd6dc330cf091329ca983a6b97506eae7342abea40cb2cd1f2dafd3f3fe582624b013354ac5ef8f14a1f5f6ed7fff6b7a6dc367257142d217a21a34698fc9f707f6a7d7d5b5703a3f6bb616cc53b964941b3f9924660a4f76ef2056a513dd9a53d117a53101217b122a57c229d9df8003b5ff251b2a48ce05228d318c6e011619d3a181784cd95c73ecced85a59ddc1ebe37588ad6f35036d4e9163477ce6c8deef14412c9d00b699ebc49f27919e112b2ca6dc56fc46c6589d2c4fdadc924c57212151cac0a8259145f5fbc35c79ba6b3a80e9e65a5ba92bc3645e2c72e00f3b0f4c68220fb44d476efb5583c1bb22763212bb6a4452b086062ba81c688e4383e8992cbb0c00cba2502286400456f44353b3f2650fc6e358b8f027fcadeda8637cb79b92b7051d33c018a82df2ee91bb7e562742d7c0e38400a3a8aba8cc737feaece5b33a9d198d2f5f469ce0dd2df623d0f5da627a62552a86fb62ade250f3854ceefae4d2fddb40ab75af47b718b12b6c01d55efbb27241b0fb095959a937452ae34a0875ed8ff289bd5bf501f118dec6e03c30184e5e662ffd0dc45ba9ed88ec0c18c346ad6e05bf03a5c3050cb12b9c7a1909f0ecf7bead4b47663dc820d3bdab1444a316f38349b97a43b24a23503ac610f08f55fe588050ac8aef8a265a044da756e9f50d49ee8a20c737a413c2d8a44829431fde504c6d749159ae71434df07ba415caef545f67a661ae69f923608582fbc1407999205ddf44d353f79992911c720eed1a8783d5dddc922ee5d976aaabcf550248526b8b92384211295069a38b375b825a8034d68c55625d9c3db92ae1d204a79953a05f94901c6085b530a257b53b5328773cccdb4431423c3c17a9036935413a166438cf77f794a1ab1d4e250c424ca15ffca45367031c8741d4b2786a2d4c5269533d1daece04bd743c0b87841864892ffa09dd095e1b79ab81de3c5649c3d4947bfc081e47e317bb82fe3849b30a53474354593e11b21e923eddcec119a8321028fda38a54d3f806e3b6cf1c189e258101708fb2d1d8b964c4603ab1f31bbe8e94d3c795ef86ac5ae4db9e948e66c90d96396e406f4231dac867e8212979c65ea88118e4455ddd39f809e5db32434d79e4f0d316ada17e0cebbeb3c87718880815cfc7233fc848348051287fd767f25be621ddca5d87f4dc46ef5a4097237835590af109f080efb37e9b5d27a93e3651995cd959eed5276a362d6c47d0b27eb076ea4766454c2a23ea86cda6bc51ac26f467afdc62bb4349f5815f6d932812f79aa1cf177074bcf1095910f6eed609e75511f8ca5e7e0bc30cf2f418fb72fe8833123f4fefd6b2be6a4bf99ef535e35a6dbe31705484e8226487b4071e45ba3755f9198addb7e6acf5ff453544053754a7c7bff133e4c3f4fb3d975cf2a1953af6482a44858dfa2c6c3d214e0ae68b11373899f4f890db70e5b92f541fdf886b8febc076a1b56fb9d2d143462531f41cc612d93bb1d111e8573596b7635c64ae53b6d72c7fb0efdedb86a7b366449658c62bc8efb5e837c64f99a2b87e2b9d3c95e2767979ab0033448bb3998131ea34f2b97334ca9babe2a083fd83a1994c374832d79c1cd2e3c35c18c528a51b67c3b178fbbbbf6e3bcf87a26943f22c3027bce7f6b64b8e87dbe7ad7782030ca1c17f7f9e5d05cd5be3c7a3b9c7c7eba8572b8d132fca39d895ba40cffa78ddb6faced65f397fd988d5edcbe50221ea74bd20f9e5068b95f2d5eef455914eba4d1d73849ff37d19ac3202782faf386e91182d158b9b6bce4e7af6f2d84825095d7c5f0b7fc871e767fa2ed7e27011cdebcfc3041596d4ae35a0ffa67831bdc28d90edc0fc7adfabcac229c2bbc63b7e81c9b52e4cb0dbae86a5a505ec63015efe5dd693d384c3dc9089559f1edd55229c1d9bc922a6486a0998ffab1da4272a248fa4139cceea5b8484d8ba44aecf1fcea1e08a0c505732edb741ae601fda6602b88c0e3b120811f98bea9e7e784fa4fe780a2d1bb6349598170dceeec630227b349a567a0752b246c256da02dd1e4191ff47ec08d5696c6e74a893906c605eea7a931c3e0c15469f777cfac74e23ad0946782f9cc4bd0e23d900ba5d5eb4a93fa26f7d564f406d36a64eaa2ac5f871fc655d5b321439b4d59f1946d85f240a432d5e417aec58958cf610abd7c0d8691c3605e6d9b242191e09a1af2fef5b1941af1d8bc574da7c2c593afb787bc22564d2d9748ceca5a532d5c47f6b03bd1b18e017d1d99e03f8f5b4c92edb636b71d7bed9148cf2b8860485a9021002ccbc4a6f828a51b8f0243b2d01be6870b9a9371dba5ed576730432e776b646215c23c31cd9513019cf3aaa9fbb0f7175c7c3a49ce3c5692a8a6c0c28b3b3533b868ba0dd433b0f28214e87602467f0d07c3c42b60681a86aae80104f28755dbfcf1eebd98220813c77a31f7d117fb974edf7a3587849423fdade054bbb77fcb02a5e9e4c338f268583d931a7085b560612e38440a1b7c6b915c34eee7f744f1446c60f9ef827a510f6a7dcf29e4dd62d7093c19419f7f5e236a7277da528b6326c39b1918ad65075e6787838587517f54d863d21546348069caf20292a1a60aec92d29b0b28867ea77768abc66889da81d4bcafb7d3194ca1ece101dde50437b206c2254ddacc84905e7431b5803f8ded242592438d57f12f7f716b52b956df7f63890eedcb0fbe369c36fdb922554c0ad0f80d31e5552f2e1435283322a6720e8d6b6787c7b5505972069d6bcf3ea183f294b7ca66f9285733ada0ec29286479fd83a002d7303cf9d83ead9a66a260693d16b23201d664e8b9ce7be69b515d0c61a10fec5551a2a0a725e4d17d2e3bc35c5ae5b90ed9411c5368514375574d52e815f24d35737d065608c532fcc08f6d7f12fcb04ae98ef2580bcc2cb3e001963edcfe3f2f849740a1bb944deb327b36baf4bf7a11071abe7a80c2fa775837784c05866ea3a0515d58fdf261ffbd48995b051fa76d06b372ee7027f1d2bc7b8ea85ab6bcbe298696a653bfebf9aac0f4eba96dbec8e349681eb981377bbe696621b35e6a00057bbe789546c00b352236cd3e737092354333eaff27b5e6da38d52d29fe1119eb06e31aae50daad7c201a8a0dda2dc1f0cf08700573d6d7fb46a68c4021df79240ddc984008fd95ec8411f84466ae02855c7f36ce65d61bf2c4872e0f7c19f617eefb41fe63cdd0a8ef379a1e05e1d03094cc887d15cc7289eb670122de2c8db1edf30dd32287faf5e7a06fb09481edb09f291109deae4ce5b95e0f64c1518d6d577dc0698ff845fb87b6531a9a80633e8e2b5104c1fda28493ccec06e97ab49c9417d8e021172f4a354530b09cc04b4dab97e30ed8526973b603ec2252140144060626f3f5b52811b782e9485ebef5ed6651963bd46db777148ec31f1d3131cf2de393f3273fd96eb959ac19240fb9fe2655a2ca9e0a375c08b651513c509d43938bb0ea6fa75313af728c84d95a5e4e73dcfcc3a162239c4bf168676fb85d170816680857adfa0c642ee02d7e7be6556b717af553f6365f6592b66ac891ef048f5a972d9eab2ce4fd616666d4c204c0911037df661791c007d1f723fa09d830beadf1f7df4c6d3de47cd57de9382a0263570f84079efd71ce3c403b00c88f43ab3e2cfcc0460daa0d1ff5851ec08fd489fbc177335b142ffe5ad56f1fb47e716b9191eb1a0934b50a54ce140849643e52f7ceeef7f37fa9742fc6fe00ce45a5c23b8ec0b57793446dffaec5a8bc49b6f1dc888a7561b4cf254c181d8094c595e8ab0735aa19968ba98df60122e514b102cd33d4631c48706bb306a631b51b26beefad12394b623d2bdc3ba9fe1143f505cf83293eb5ded103ce9a0253a93a51e17fcffb7542dd53cb5eabd161fa11b303dc998b06f0825063cd35a8c9bbaf8b851913841936d6ac1055eeedb46b1747f34901c8424c89dcccadeb55a6aeb221db207f6bac82d050f450b1ab9705bdfce0afaf7233dbde99e235322ceed9f87ec89f56c3e761e659fd7feb43b95d6d00c0edb71b39b8a1bbf6a2d48d19e74e66726b52ffa8ec8a325874672e4d579da3077816251bd9055f7e84cc125590e697206f1b5add10f8d0512a75cfed31a5eb02ec1df00fa05aaf0c607b4231f45f67b25bc63eb5e685564a0f5e5fa4415db1af84ce51ede613aad4956ce6a0e1fcfd876d77f709bad64c73694d913fcbf623f3f4dbbb83c7528bf4f467ad9c554399460efdaf8d5a146cf787bb6ae40f3d5e35d73b2a5f644400d7abd5108d110dac5a2f97e38e95ada54217f13b5aa3dfe8c7a91af68c653424dcb23cb5d9427b13bdc7cc17cee4672385e9a7271b009a31508ff741d59a63ccbd0fda8c9a277429d4716df317d3f17df9fdaf2c27907ac48dd483ed6f5e810ab19768fbfae10919f9e3dc45cf1b6427bc5a122a9b7f7431860701c40e6b39fc895f3b7e31531c74c12ac115fe470fa1fb1464d0c06d580161efc1f97d871e8349b5a0f4d0470593417836e31e1bf019ac45982d3a7ac3660ef3724b628190643fdc326065ddc7c0e5a1bebdb0c31815dcd1fd0684de7f945a744c28e6ebe7ab1cf2f0f1ee4cfec6d86b270250c1397479161ecdb89b1c26f22b57bbc2d5bb816bf2e644f357246569c48c151bcc68a61ffbe0cdb78ac2e32463645fb11e024debf65370d5a33cff7f74da7a93e7debcdc9d9571fe1b891fc3028bc60718d2daebd397d8c6ec5a63fc8db5d34636f5c84e93867c37f7fb65a2aab40fd1a29dbd70a6d1db3b1888653e1154a7d0c39a496442a9a974a49761da78a035d0a62962ef3f91b4c1a1320cfb7dee163c338ea915d9fed3c4e6d697987fde8daf5c8fb178c8939be22b170aff7252e9d9977d911200424c236a6d01c3b07a5ef977edf95030bc45e0ec5991d27bd69267ea396487173cfcb760723bfea5c504bdebf545d62a3e3266444da7503e0076cfbee8d0d7a685e630425916962ea6e87e87403517e3f4f8d0ccee3a51a3fe3cf7b17a6e081b96b2804c25d42689033f37940caf30615292ea82f91dd0dbada7bb9db219b99d34e33a9cf35fe38115d914fb4c5e521fac8351018b45943cbf0c48ddf0bb3da4caf5e36264d6e7a7151915b0d18a48597c85cbba6089d81a2f3732e52e0fe3ad95fcfd3e0330fbc8d8827e9af83ce61ac11afbc02aa967d5584641e9012943552960c71a367b481746b519f0ecb022f0d3bffbe5b4c05c5c57168e8d068d6ec7ee12568ce448a14f98593b87e74e113067bb8878becbf20e588730c5d19b2328f3b5068f9613cdebebfe97cc8216394c3941cb2fc0bbf759bf3546d5ddb9a06f32ca5dc00c916cd73be270000ac7a5c1a270790afa2779f26b24911215c6ca7fc0842233ecb01fdb29defd1c4658ab630b29c1bc5606222aea95a2cdd3b72ff2a3f7fd17a41e65d1864eaa98108c9d1faaccc2354c66c0ab8c0305354799e083617945f3e93c57e18003246aef4242b33ffca34077e797d3808cf842d43e0d020bab472140b1d5944c12e55c7907ec54ed07960d1711a876ae8ad0943d041ddb41f1d93e6913f9ac69eff4abf20eeb8ffa4493456af8d3f7e83b6828471dda3bdab305bf3638ddf96c45334d1e87b10b00fce073307d07bc4d452a9e399b78019681ff174829557b836a6da8445256abae17039ae1d2c549ce8aa9609ecaebe2a91d40f434aa086afe9d7d20d502e1b0e821d6c5517e9ada00fc30900c9265ca1730499872880ddc9405a6d0da0dee267806a426488b96c9554a4d72594c0bced33216b63a705e508e3e3cdcc8001fa7a980ac089b8b1bb2bb1bdb81fcb39f33f826296b78dde75d81083c9c297f7abadb9cadd04bd68ad092de4d0c7652c3b607c91951f489560552a3bad48a28c1a8a9100e6a809f5cea4230e06cdebfc354d795e1dbe811583fffb0e34b4f61e50962e8ef00ef37d3ee9f8b73884b2f8d769c05ff6697799fcf11d69dbc664f4cd0f92aa137476f983340a56bed6f927221e73e63ea7ddb09ac90b9ac26d6df312fc0d56a5732d8c016554f3e0dece9babbafde0b91e24d68a3f982af037926d4f916446f3942e98f5e354e258787596222ab27fdb8bfed4315d796548fdf9a097a0fd081fa831c9ac1d23edec5903ca42a2741e60d5360c93c40f543633bd15efa1e7890bfc8eb5a427ccd5f04ddeedfb7764a978e5728de52131ae97012b0ee4d64fcc0b20f34629bb83f12c1c9def252b79209bc53f7bce184395ffce842bca7add5fbadb71fc88f7147ad3d5130d78ac52e81129241d22a53fd30e5bf1592e7d46702512cee06a8698790e8c0d379ac617a005b23ca4c8f66ed5c783a4a9800e55c669bc75a1d0fb29ca2ef64626a53ae773e0fdcd0108d7452494470bba05b05768719d32d78735c84373b959f95c3cd391591bc9f8ae6079b67557d885250beac9fa7053b43b9a652795a7a82ff0ea65f3c17916e3a3d3c5f7a139fbf52398ebf73adc74deb52db87dd24680dbb782cef9cdb2518f2de0d18377ac3b757a21d788104fcc1dca1c3aa0a980a468b9d3d72112097cc276a96fe7a906a6780e5d2bb3ca26769d13ae1d1800ca3a2240907be43214b8159b1843497030f870c90143159abfe4792edefc7aa2a3c59c280c379f200976129f495d8f54436e5fedbec704c62d5a8d711422cfe5a2b287e1967401fe224202cc76ac79c4414ea4182afc21c13e419922084c53d29371cb74ee2b51a1421da766d6f2271d000bb281a77f71b049dffb1c8b7d32158b04ead042e1358ccba4bbbd4211956b354225833693e5171ec78cea4beaddd5c1cd37fa8f796b5cffcf6a7b443d5c02399af4160ece8e0ad685f34ed725c94250df23012f96678da18d5e2db891eda9b1183e387e86156ee65cd25f1b86b2aea5129f863bf7c481e088274b47730835279898a93cd3b3f01269ae63b75e169b00536d630e71b4ade04b23217c099854995993b972654375a3497a84485eae149d75db7567ea49c81a506671eda1d03ca08d55e451df2f72a5616a0134158a24df0706a851615c62730b0e824a614e4cdd5ca2b62c6be0d16d42a25b97d7dd09af4ac2187b8e4acad9323d0d561708ece196cbd385bb36be2a3db76142a84d69ae8cef0f72a6e2d992aee60e09cf8bcb4112e8037a76792e215ec9f344ed1e26c854a162f96a0008bbd0140e582a4f9b4263880a7db4bb5bad09cdb22b6e36f17f3da0756775295a66134ce227f3d1077e2184c85376dea1ddc79af170bc8056851cb2c7afc841294e238d4d0bd7497ded1c7c397e8206043441c4b56ec90f9aaa8519adf0baf5d81f07888e724a497d17ce6d8880507007beec8aafe1ff89b6300f27b5ef2e931b05da18e4e8b9fde2768d8277474d161e5e134f16ff5f23a37eeb3269efd64e66c45b27dee7454f9a9275ca79c87d11a3bb3c7aa3d604cd91be4447bc6a50ce50ee4e2b88e3e9cb65b46cf3af7c0746211d2d6774cf6fbad97c560f8df8d130783d8107b3e5c334ff2d51f2342a2bfdf4e020688adc0fcf1e36dc907ed5e0d21721fc66925c37b0492287e6aa83823b8c668155706cad3219aec18608cf895975651351ab40fc51ad9dbdeaea651cfd95c117f27b08b65354c25d742fdafd5d0f523f0e02f58329becfcfdc9d281acec24edbb70fc1988938b73b078259416d6c3c96aa95acdb8018b6fa18543f7a164593ebc41ed79f7f8224325fb5d2f6db4053e5526aa520f1cfcd9f0aa8fc0ebc816550b75fb6141d18442c96209d93d8a7588e46c07575d779d3add78537bc578c4dd794255d8f412b29d5784f3f538cb36c6183666af089943c0f89292ae9177526771ffbbe34f8e8ba8f437c7e581fdd915dfb97f3e92dc1a936efebb13d70d504647b63399fd0b7d30b1e0af4b8efd05f93ecafa08816a4c96df9d169992d3ead3f011907fa7685c53d9c54dd51fb84e94a85ab31d20e106423beea4b4e5a32e8f1c0d132e56e5d89aa7f852d2b218f9b565d0464a8feccda9f048f5a65bb2c4ee0450bf8c05a08444781bf5bbca4615e55bb8f8c2e8b3088647e8b785ed4606146b4dbc9d24656086719d5e8ad5cbfe791c53a39f6eff754e22f67e7f30b1950c58630ecba7724f10f2e5f1ebab38f86b67bffa217e4990a0a450b70ea64242a6519d41bb2086053c9e85a36093cb73dfcfd8741306c078ed3ea1e867f6bd7c7e1790ff69bb1bc9bfd4b456a7dfb7e13276a09eda68b1de4edc8fd6b50f7848f0b7438e77b119b5e079aa2ab0f3df6c488ab4d0c81bfe8273cc68dc954c2f152f917b0f2f45a2fd0b5b3d55abd12725a522cc958cf884e49841ebb6f5cdab6a9</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>题单</category>
      </categories>
      <tags>
        <tag>BZOJ</tag>
        <tag>题单</tag>
      </tags>
  </entry>
  <entry>
    <title>TO DO LIST</title>
    <url>/2020/10/28/TO-DO-LIST/</url>
    <content><![CDATA[<p>列一下计划，接下来有主次的完成。</p>
<a id="more"></a>
<h3 id="语言">语言</h3>
<p>C++指针多学一点没有坏处的，不开O2比vector快的不是一星半点。</p>
<p>python一些常用库也要学一下，考试能用就是赚到。</p>
<h3 id="模拟">模拟</h3>
<p>感觉自己代码能力有待加强，很多没有固定套路的题写着写着就写死了，实现方式比std复杂太多。</p>
<h3 id="基础算法">基础算法</h3>
<p>贪心和倍增要多练。</p>
<h3 id="搜索">搜索</h3>
<p>A* 和IDA* 要多练。</p>
<h3 id="数论">数论</h3>
<p>练习：莫比乌斯反演，杜教筛，原根。</p>
<p>学习：线性基、exBSGS，Pollard-Rho，Cipolla。</p>
<p>顺带一提exLucas的出题人没妈。</p>
<h3 id="图论">图论</h3>
<p>练习：各种建图技巧（拆点、分层图、数据结构优化建图等），二分图建模，网络流建模，kruskal重构树，圆方树，欧拉回路，差分约束，长链剖分。</p>
<p>学习：Prufer序列，矩阵树定理，最小树形图，k短路，斯坦纳树。</p>
<p>顺带一提卡Dinic的出题人没妈。</p>
<h3 id="动态规划">动态规划</h3>
<p>很多时候看出是一道DP题就已经做完一半了。</p>
<p>练习：各种优化技巧，插头DP，概率DP。</p>
<p>学习：单调栈优化。</p>
<h3 id="数据结构">数据结构</h3>
<p>之前一度沉迷数据结构导致水平没有什么提升，各种树套树和Top Tree还是一边靠吧。</p>
<p>练习：Splay板子还是不熟，线段树分治要多练。</p>
<p>学习：李超线段树、非旋Treap、块状链表、珂朵莉树、可持久化可并堆。</p>
<h3 id="离线算法">离线算法</h3>
<p>NOIP目前还没出现过强制在线题，离线算法在想不出正解的情况下能有一个相对优秀的复杂度，还是有大用的。</p>
<p>练习：整体二分、CDQ分治。</p>
<p>学习：树上莫队、回滚莫队。</p>
<h3 id="随机化">随机化</h3>
<p>随机化算法基本就是模拟退火了，要打熟练，运气好的话还是能得很多分的。</p>
<h3 id="字符串">字符串</h3>
<p>练习：KMP、Trie树，AC自动机，后缀数组，后缀自动机。</p>
<p>学习：回文自动机、子序列自动机。</p>
<h3 id="多项式相关">多项式相关</h3>
<p>说实在的多项式全家桶到exp和快速幂就够用了，不要沉迷模板，多元拉格朗日插值什么的还是一边靠。</p>
<p>练习：各种模板要打熟，牛顿迭代要弄熟，保证能推出来或者结论不记错，字符串题还是要多练一下。</p>
<p>学习：下降幂多项式。</p>
<h3 id="组合数学">组合数学</h3>
<p>练习：组合恒等式要记熟，斯特林数和生成函数还是要多练一下。</p>
<p>学习：Burnside引理</p>
<h3 id="计算几何">计算几何</h3>
<p>练习：扫描线还是很有用的，向量基本操作、凸包模板要打熟，Pick定理，凸多边形面积要记熟。</p>
<p>学习：半平面交，旋转卡壳。</p>
]]></content>
      <categories>
        <category>计划</category>
      </categories>
      <tags>
        <tag>计划</tag>
      </tags>
  </entry>
  <entry>
    <title>「SDOI2015」约数个数和</title>
    <url>/2020/11/25/SDOI2015-%E7%BA%A6%E6%95%B0%E4%B8%AA%E6%95%B0%E5%92%8C/</url>
    <content><![CDATA[<p>莫比乌斯反演。</p>
<a id="more"></a>
<blockquote>
<p>题目链接：<a href="https://darkbzoj.tk/problem/3994">「BZOJ 3994」</a> <a href="https://loj.ac/p/2185">「LOJ 2185」</a> <a href="https://www.luogu.com.cn/problem/P3327">「Luogu 3327」</a></p>
</blockquote>
<p><span class="math inline">\(d\)</span> 函数的重要结论：</p>
<p><span class="math display">\[d(nm)=\sum\limits_{x|n}\sum\limits_{y|m}[\gcd(x,y)=1]\]</span></p>
<p>证明：</p>
<p>设 <span class="math inline">\(n=\prod\limits_{i=1}^k{p_i}^{a_i}\)</span>，<span class="math inline">\(m=\prod_{i=1}^k{p_i}^{b_i}\)</span>，<span class="math inline">\(x=\prod\limits_{i=1}^k{p_i}^{c_i}\)</span>，<span class="math inline">\(y=\prod\limits_{i=1}^k{p_i}^{d_i}\)</span>。</p>
<p>则 <span class="math inline">\(d(nm)=\sum\limits_{i=1}^k(a_i+b_i+1)\)</span>。</p>
<p>因为 <span class="math inline">\(\gcd(x,y)=1\)</span>，所以 <span class="math inline">\(c_i\)</span> 和 <span class="math inline">\(d_i\)</span> 至少有一个为 0，<span class="math inline">\((c_i,d_i)\)</span> 共有 <span class="math inline">\((a_i+b_i+1)\)</span> 种取法，与约数定理得到的结果一致。</p>
<p>然后是推式子时间：</p>
<p><span class="math display">\[\begin{align*}d(ij)&amp;=\sum\limits_{x|i}\sum\limits_{y|j}[gcd(x,y)=1]\\&amp;=\sum\limits_{x|i}\sum\limits_{y|j}\sum\limits_{p|x,p|y}\mu(p)\\&amp;=\sum\limits_{p|i,p|j}\mu(p)\sum\limits_{x|i}\sum\limits_{y|j}[p|x][p|y]\\&amp;=\sum\limits_{p|i,p|j}\mu(p)\sum\limits_{x|(\frac{i}{p})}\sum\limits_{y|(\frac{j}{p})}1\\&amp;=\sum\limits_{p|i,p|j}\mu(p)d(\frac{i}{p})d(\frac{j}{p})\end{align*}\]</span></p>
<p>设 <span class="math inline">\(n&lt;m\)</span>。</p>
<p><span class="math display">\[\begin{align*}\sum\limits_{i=1}^n\sum\limits_{j=1}^md(ij)&amp;=\sum\limits_{i=1}^n\sum\limits_{j=1}^m\sum\limits_{p|i,p|j}\mu(p)d(\frac{i}{p})d(\frac{j}{p})\\&amp;=\sum\limits_{p=1}^n\mu(p)\sum\limits_{i=1}^{\lfloor\frac{n}{p}\rfloor}d(i)\sum\limits_{j=1}^{\lfloor\frac{m}{p}\rfloor}d(j) \end{align*}\]</span></p>
<p>预处理 <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(d\)</span> 的前缀和，询问整除分块即可。</p>
<p>时间复杂度 <span class="math inline">\(O(n+T\sqrt n)\)</span>。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">50005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> ntp[N];</span><br><span class="line"><span class="keyword">int</span> pri[N],prc;</span><br><span class="line"><span class="keyword">int</span> mu[N],c[N],d[N],smu[N],sd[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ntp[<span class="number">1</span>]=<span class="number">1</span>; mu[<span class="number">1</span>]=<span class="number">1</span>; c[<span class="number">1</span>]=<span class="number">0</span>; d[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!ntp[i])</span><br><span class="line">		&#123;</span><br><span class="line">			pri[++prc]=i; mu[i]=<span class="number">-1</span>; c[i]=<span class="number">1</span>; d[i]=<span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=prc&amp;&amp;i*pri[j]&lt;N;++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> x=i*pri[j];</span><br><span class="line">			ntp[x]=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				mu[x]=<span class="number">0</span>;</span><br><span class="line">				c[x]=c[i]+<span class="number">1</span>;</span><br><span class="line">				d[x]=d[i]/(c[i]+<span class="number">1</span>)*(c[i]+<span class="number">2</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			mu[x]=-mu[i]; c[x]=<span class="number">1</span>; d[x]=d[i]*<span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i) smu[i]=smu[i<span class="number">-1</span>]+mu[i];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i) sd[i]=sd[i<span class="number">-1</span>]+d[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&gt;m) swap(n,m);</span><br><span class="line">	<span class="keyword">int</span> l=<span class="number">1</span>;</span><br><span class="line">	ll sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(l&lt;=n)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> r=min(n/(n/l),m/(m/l));</span><br><span class="line">		sum+=<span class="number">1l</span>l*(smu[r]-smu[l<span class="number">-1</span>])*sd[n/l]*sd[m/l];</span><br><span class="line">		l=r+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	sieve();</span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">	<span class="keyword">while</span>(T--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> n,m;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">		work(n,m);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>BZOJ</tag>
        <tag>Luogu</tag>
        <tag>SDOI</tag>
        <tag>数学</tag>
        <tag>莫比乌斯反演</tag>
        <tag>LOJ</tag>
      </tags>
  </entry>
  <entry>
    <title>「学习笔记」Pollard-Rho</title>
    <url>/2020/11/20/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Pollard-Rho/</url>
    <content><![CDATA[<p>Pollard-Rho质因数分解。</p>
<a id="more"></a>
<p>Pollard-Rho是一种玄学随机化算法，可以在期望 <span class="math inline">\(O(n^{\frac{1}{4}})\)</span> 的时间内找到一个 <span class="math inline">\(n\)</span> 的非平凡因子（除1和 <span class="math inline">\(n\)</span> 外的因数）。</p>
<p>Pollard-Rho本质上是通过随机两个数作差和求gcd来增加随机到因数的概率。</p>
<p><strong>随机两个数作差：</strong>假设 <span class="math inline">\(n\)</span> 的一个非平凡因子为 <span class="math inline">\(a\)</span>，对于 <span class="math inline">\((a,n-a)\)</span> 的任意一个 <span class="math inline">\(x\)</span>，随到 <span class="math inline">\(x-a\)</span> 和 <span class="math inline">\(x+a\)</span> 均可得到 <span class="math inline">\(a\)</span>，概率扩大了近一倍。</p>
<p><strong>求gcd：</strong>只要随到与 <span class="math inline">\(n\)</span> 不互质的数即可得到一个非平凡因子，概率扩大为 <span class="math inline">\(\frac{n-\varphi(n)}{n}\)</span>。</p>
<p>Pollard构造了一个序列：设 <span class="math inline">\(f(x)=(x^2+c)\bmod n\)</span>，<span class="math inline">\(x_i=f(x_{i-1})\)</span>，其中 <span class="math inline">\(c\)</span> 为一个 <span class="math inline">\([1,n-1]\)</span> 的随机数。</p>
<p>只要每次取序列的相邻两项作差求gcd，那么随机到 <span class="math inline">\(n\)</span> 的一个非平凡因子的期望次数为 <span class="math inline">\(O(n^{\frac{1}{4}})\)</span>！</p>
<p>但是这个序列也有一个问题：<span class="math inline">\(x_i\)</span> 的取值范围为 <span class="math inline">\([0,n-1]\)</span>，所以一定在某一时刻会代入之前出现过的值，然后开始循环，于是序列形如一个希腊字母 <span class="math inline">\(\rho\)</span>。</p>
<p><img src="data:image/png;base64,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" /></p>
<p>虽然 <span class="math inline">\(c\)</span> 在 <span class="math inline">\([1,n-1]\)</span> 中随机的话 <span class="math inline">\(\rho\)</span> 的期望环长为 <span class="math inline">\(\sqrt n\)</span>，但是也有一些不好的 <span class="math inline">\(c\)</span> 会使环长过短，以至于走完全程都没有找到 <span class="math inline">\(n\)</span> 的非平凡因子。遇到这种情况只需要重新随机一个 <span class="math inline">\(c\)</span> 即可，并不影响期望复杂度。但是这就牵扯到一个新的问题：判环。</p>
<p><strong>Floyd判环</strong></p>
<p>取两个数，一个以另一个的2倍速跑，由于速度不同所以一定会在环上相遇，相遇后退出。时间复杂度 <span class="math inline">\(O(n^{\frac{1}{4}}\log^2 n)\)</span>。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">R</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> ull seed;</span><br><span class="line">	<span class="keyword">return</span> (seed+=<span class="number">4179340454199820289l</span>l)%n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">F</span><span class="params">(ll x,ll c,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (qmul(x,x,mod)+c)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">pollard_rho</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll c=R(n)+<span class="number">1</span>,x=R(n),y=F(x,c,n),p=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(x!=y&amp;&amp;(p==n||p==<span class="number">1</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		p=gcd(n,<span class="built_in">abs</span>(x-y));</span><br><span class="line">		x=F(x,c,n);</span><br><span class="line">		y=F(F(y,c,n),c,n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>倍增</strong></p>
<p>倍增算法更加简单粗暴。假设当前走到了 <span class="math inline">\(x_{2^k}\)</span>，则把 <span class="math inline">\(\prod\limits_{i=2^k+1}^{2^{k+1}}|x_i-x_{2^k}|\)</span> 与 <span class="math inline">\(n\)</span> 求gcd，如果大于1直接返回，否则走到 <span class="math inline">\(x_{2^{k+1}}\)</span>。</p>
<p><strong>127优化：</strong>显然如果 <span class="math inline">\(2^k\)</span> 过大，则<span class="math inline">\(\prod\limits_{i=2^k+1}^{2^{k+1}}|x_i-x_{2^k}|\)</span> 大概率为 <span class="math inline">\(n\)</span> 的倍数，效果不佳。那么就每127个计算一次gcd即可，同样优化了gcd的log。（玄学算法别太纠结为什么）</p>
<p>时间复杂度 <span class="math inline">\(O(n^{\frac{1}{4}}\log n)\)</span>，其中 <span class="math inline">\(\log n\)</span> 为 <span class="math inline">\(n\)</span> 的质因子数量提供。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">ll <span class="title">pollard_rho</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll s=<span class="number">0</span>,t=<span class="number">0</span>,c=R(n<span class="number">-1</span>)+<span class="number">1</span>,k=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		ll d=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=k;++i)</span><br><span class="line">		&#123;</span><br><span class="line">			t=F(t,c,n);</span><br><span class="line">			d=qmul(d,<span class="built_in">abs</span>(t-s),n);</span><br><span class="line">			<span class="keyword">if</span>(i%<span class="number">127</span>==<span class="number">0</span>&amp;&amp;gcd(d,n)&gt;<span class="number">1</span>) <span class="keyword">return</span> gcd(d,n);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(gcd(d,n)&gt;<span class="number">1</span>) <span class="keyword">return</span> gcd(d,n);</span><br><span class="line">		s=t; k&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后是分解质因数的完整代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[<span class="number">8</span>]=&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">37</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">inc</span><span class="params">(ll &amp;a,ll b,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qmul</span><span class="params">(ll x,ll y,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll d=(ll)<span class="built_in">floor</span>((ldb)x*y/mod+<span class="number">0.5</span>);</span><br><span class="line">	ll res=x*y-d*mod;</span><br><span class="line">	<span class="keyword">if</span>(res&lt;<span class="number">0</span>) res+=mod;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll t=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) t=qmul(t,a,mod);</span><br><span class="line">		a=qmul(a,a,mod); b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">miller_rabin</span><span class="params">(ll n,<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll d=n<span class="number">-1</span>; <span class="keyword">int</span> r=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(d%<span class="number">2</span>==<span class="number">0</span>) d&gt;&gt;=<span class="number">1</span>,++r;</span><br><span class="line">	ll t=qpow(a,d,n);</span><br><span class="line">	<span class="keyword">if</span>(t==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;r;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(t==n<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		t=qmul(t,t,n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isprime</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;=<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(n==pri[i]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(n%pri[i]==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(!miller_rabin(n,pri[i])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">	<span class="keyword">return</span> gcd(b,a%b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">R</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> ull seed;</span><br><span class="line">	<span class="keyword">return</span> (seed+=<span class="number">4179340454199820289l</span>l)%n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">F</span><span class="params">(ll x,ll c,ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (qmul(x,x,n)+c)%n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">pollard_rho</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll s=<span class="number">0</span>,t=<span class="number">0</span>,c=R(n<span class="number">-1</span>)+<span class="number">1</span>,k=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		ll d=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=k;++i)</span><br><span class="line">		&#123;</span><br><span class="line">			t=F(t,c,n);</span><br><span class="line">			d=qmul(d,<span class="built_in">abs</span>(t-s),n);</span><br><span class="line">			<span class="keyword">if</span>(i%<span class="number">127</span>==<span class="number">0</span>&amp;&amp;gcd(d,n)&gt;<span class="number">1</span>) <span class="keyword">return</span> gcd(d,n);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(gcd(d,n)&gt;<span class="number">1</span>) <span class="keyword">return</span> gcd(d,n);</span><br><span class="line">		s=t; k&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">pair</span>&lt;ll,<span class="keyword">int</span>&gt; &gt; fac;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decompose</span><span class="params">(ll n,<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;=<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(isprime(n))</span><br><span class="line">	&#123;</span><br><span class="line">		fac.push_back(<span class="built_in">make_pair</span>(n,c)); <span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	ll t=n;</span><br><span class="line">	<span class="keyword">while</span>(t==n) t=pollard_rho(n);</span><br><span class="line">	<span class="keyword">int</span> k=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(n%t==<span class="number">0</span>) n/=t,++k;</span><br><span class="line">	decompose(t,c*k);</span><br><span class="line">	decompose(n,c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例题：<a href="https://www.luogu.com.cn/problem/P4718">「Luogu 4718」</a> （Floyd过不去，倍增要用 <span class="math inline">\(O(1)\)</span> 快速乘）</p>
]]></content>
      <categories>
        <category>学习笔记</category>
      </categories>
      <tags>
        <tag>数学</tag>
        <tag>Pollard-Rho</tag>
        <tag>质因数分解</tag>
        <tag>随机化</tag>
      </tags>
  </entry>
  <entry>
    <title>「学习笔记」Miller-Rabin素性测试</title>
    <url>/2020/11/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Miller-Rabin%E7%B4%A0%E6%80%A7%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<p>Miller-Rabin素性测试。</p>
<a id="more"></a>
<p>给定一个数 <span class="math inline">\(n\)</span>，判断是否为素数，<span class="math inline">\(n\le10^{18}\)</span>。</p>
<p>Miller-Rabin素性测试基于以下费马小定理的扩展：</p>
<blockquote>
<p>如果 <span class="math inline">\(n\)</span> 为素数，提取 <span class="math inline">\(n-1\)</span> 所有的2，设 <span class="math inline">\(n-1=d\times2^r\)</span>，取 <span class="math inline">\(a&lt;n\)</span>，则</p>
<ul>
<li><p><span class="math inline">\(a^d\equiv1\pmod n\)</span></p></li>
<li><p><span class="math inline">\(\exists0\le i&lt;r,a^{d\times2^i}\equiv-1\pmod n\)</span></p></li>
</ul>
<p>至少有一条成立。</p>
</blockquote>
<p>这个测试存在一个问题：虽然质数都能通过，但是合数也<strong>有可能通过</strong>，并不能保证百分之百正确。</p>
<p>那么就多找几个 <span class="math inline">\(a\)</span> 来提高正确率即可，经测试， <code>2,3,5,7,11,13,17,37</code> 这8个质数在 <code>long long</code> 范围内都能保证答案正确。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[<span class="number">8</span>]=&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">37</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(ll &amp;a,ll b,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	a+=b; <span class="keyword">if</span>(a&gt;=p) a-=p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qmul</span><span class="params">(ll a,ll b,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll t=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) inc(t,a,p);</span><br><span class="line">		inc(a,a,p); b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll t=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) t=qmul(t,a,p);</span><br><span class="line">		a=qmul(a,a,p); b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">miller_rabin</span><span class="params">(ll n,<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll d=n<span class="number">-1</span>; <span class="keyword">int</span> r=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(d%<span class="number">2</span>==<span class="number">0</span>) d&gt;&gt;=<span class="number">1</span>,++r;</span><br><span class="line">	ll t=qpow(a,d,n);</span><br><span class="line">	<span class="keyword">if</span>(t==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;r;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(t==n<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		t=qmul(t,t,n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isprime</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;<span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(n==pri[i]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(n%pri[i]==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(!miller_rabin(n,pri[i])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>时间复杂度 <span class="math inline">\(O(\log^2n)\)</span>，8倍常数。</p>
<p>例题：<a href="https://vjudge.net/problem/HDU-2138">「HDU 2138」</a> （数据非常水，不分解 <span class="math inline">\(n-1\)</span> 也能过）</p>
]]></content>
      <categories>
        <category>学习笔记</category>
      </categories>
      <tags>
        <tag>数学</tag>
        <tag>Miller-Rabin</tag>
      </tags>
  </entry>
  <entry>
    <title>「CSP2020」函数调用</title>
    <url>/2020/11/08/CSP2020-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/</url>
    <content><![CDATA[<p>拓扑排序。</p>
<a id="more"></a>
<blockquote>
<p>题目连接：<a href="https://uoj.ac/problem/572">「UOJ 572」</a> <a href="https://loj.ac/problem/3381">「LibreOJ 3381」</a> <a href="https://www.luogu.com.cn/problem/P7077">「Luogu 7077」</a></p>
</blockquote>
<p>考场花时间最多的题，感谢这题让我在挂了40的情况下还有一个稍微能看得过去的分数。</p>
<p>感觉跟着Jumpmelon刷题让我的思维能力提高了不少，感谢神仙瓜。</p>
<p>一个函数不能直接或间接的调用它本身也就是不存在环，题目变成在一张DAG上顺序进行一些点后继所有的加和乘操作。</p>
<p>考虑操作顺序造成的影响，后面操作中的乘会对前面操作中的加造成影响，那么就在反图上跑一边拓扑排序求出每个点后继所有的乘，然后把询问倒序加入图中，加的时候乘上它后面操作的乘即可。</p>
<p>然后在原图中推标记。</p>
<p>考虑3号操作顺序的影响，后访问的点后继的乘会对先访问的点后继的加造成影响，那么就倒序访问3号操作点的出边，将后面出边后继的乘贡献到前面出边后继的加即可。</p>
<p>时间复杂度 <span class="math inline">\(O(n+m+Q+\sum C_i)\)</span>。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gi</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,c=gc();</span><br><span class="line">	<span class="keyword">bool</span> f=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=gc()) <span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=gc()) x=x*<span class="number">10</span>+(c&amp;<span class="number">15</span>);</span><br><span class="line">	<span class="keyword">return</span> f?-x:x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M=<span class="number">1000005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,Q,a[N],f[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; op[N];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to,nxt;</span><br><span class="line">	edge() &#123;&#125;</span><br><span class="line">	edge(<span class="keyword">int</span> to_,<span class="keyword">int</span> nxt_): to(to_),nxt(nxt_) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Graph</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	edge e[M];</span><br><span class="line">	<span class="keyword">int</span> hd[N],cnt,ind[N];</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">adde</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		e[++cnt]=edge(v,hd[u]); hd[u]=cnt; ++ind[v];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line">Graph G,Gi;</span><br><span class="line"><span class="keyword">int</span> mul[N],sum[N];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	n=gi();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=gi();</span><br><span class="line">	m=gi();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> t=gi();</span><br><span class="line">		op[i].push_back(t);</span><br><span class="line">		<span class="keyword">if</span>(t==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> p=gi(),v=gi();</span><br><span class="line">			op[i].push_back(p);</span><br><span class="line">			op[i].push_back(v);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">2</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> v=gi();</span><br><span class="line">			op[i].push_back(v);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> c=gi();</span><br><span class="line">			op[i].push_back(c);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=c;++j)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> g=gi();</span><br><span class="line">				op[i].push_back(g);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	Q=gi();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) f[i]=gi();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> t=op[i][<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">if</span>(t==<span class="number">1</span>) mul[i]=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">2</span>) mul[i]=op[i][<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			mul[i]=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">int</span> c=op[i][<span class="number">1</span>];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">2</span>;j&lt;=c+<span class="number">1</span>;++j)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> g=op[i][j];</span><br><span class="line">				G.adde(i,g);</span><br><span class="line">				Gi.adde(g,i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">		<span class="keyword">if</span>(!Gi.ind[i]) q.push(i);</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> u=q.front(); q.pop();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=Gi.hd[u];i;i=Gi.e[i].nxt)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> v=Gi.e[i].to;</span><br><span class="line">			mul[v]=<span class="number">1l</span>l*mul[v]*mul[u]%mod;</span><br><span class="line">			--Gi.ind[v];</span><br><span class="line">			<span class="keyword">if</span>(!Gi.ind[v]) q.push(v);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> suf=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=Q;i&gt;=<span class="number">1</span>;--i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> h=f[i];</span><br><span class="line">		sum[h]=(sum[h]+suf)%mod;</span><br><span class="line">		suf=<span class="number">1l</span>l*suf*mul[h]%mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">		a[i]=<span class="number">1l</span>l*a[i]*suf%mod;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">		<span class="keyword">if</span>(!G.ind[i]) q.push(i);</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> u=q.front(); q.pop();</span><br><span class="line">		<span class="keyword">int</span> tmp=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=G.hd[u];i;i=G.e[i].nxt)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> v=G.e[i].to;</span><br><span class="line">			sum[v]=(sum[v]+<span class="number">1l</span>l*tmp*sum[u])%mod;</span><br><span class="line">			tmp=<span class="number">1l</span>l*tmp*mul[v]%mod;</span><br><span class="line">			--G.ind[v];</span><br><span class="line">			<span class="keyword">if</span>(!G.ind[v]) q.push(v);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> t=op[i][<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">if</span>(t==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> p=op[i][<span class="number">1</span>],v=op[i][<span class="number">2</span>];</span><br><span class="line">			a[p]=(a[p]+<span class="number">1l</span>l*sum[i]*v)%mod;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>题解</category>
      </categories>
      <tags>
        <tag>CSP</tag>
        <tag>拓扑排序</tag>
        <tag>离线询问</tag>
      </tags>
  </entry>
  <entry>
    <title>CSP2020游记</title>
    <url>/2020/11/07/CSP2020%E6%B8%B8%E8%AE%B0/</url>
    <content><![CDATA[<p>CSP2020游记。</p>
<a id="more"></a>
<h3 id="day1">Day1</h3>
<p>早晨坐车往考点赶。中午匆忙吃完饭就到考场试机了。</p>
<p>今年试机在考试前半小时，可以提前配好环境变量、编译选项啥的。</p>
<p>64位win10好评，静音键盘差评，怎么64位系统还要加 <code>-m32</code> 啊。</p>
<p>CPU是AMD的，由于对AMD的硬件不熟悉并不能很好的估算程序运行效率，OIer要学的东西真多。</p>
<p>配编译选项的时候发现一些选项已经忘记了，还忘了怎么用文件突破 <code>time(0)</code> 一秒一组数据的限制，写了一发 <code>fwrite</code> 发现也忘了，索性不用了。</p>
<p>考试开始前看到压缩包里的 <code>zoo</code> 文件夹，想到了做过的两道动物园，有点慌，但是看到只有三个样例又松了口气。</p>
<p>20分钟读完题，简单判断一下题目类型，T1年份模拟，T2位运算，T3时间线段树，T4神仙贪心。模拟题比较花费精力并且调不出来容易心态爆炸头铁，所以决定放到后面再写。</p>
<p>想先开T3发现3操作并不是前面的连续的某段且1、2操作同时存在，直接插掉了时间线段树的做法，看了眼数据范围发现只有某一操作不存在的30分可以拿。</p>
<p>又回去读了一遍T2发现 <span class="math inline">\(O(n+m+k)\)</span> 的做法非常傻逼，主要是对 <code>unsigned long long</code> 的处理，以及 <span class="math inline">\(n,m,k\)</span> 可以等于0，可能有坑。更进一步只有 <span class="math inline">\(k=64\)</span> 且 <span class="math inline">\(n,m=0\)</span> 的时候答案为 <span class="math inline">\(2^{64}\)</span> 需要特判。10分钟写完过了大样例就没再管了。</p>
<p>T3再次读题发现函数不能直接或间接的调用自身也就是不能成环，于是就变成了在一张DAG上操作。然而操作顺序对答案的影响并不是很容易统计，想了一些离线算法但并没有学过DAG上的操作，能维护先后顺序的线段树合并/平衡树合并复杂度一眼假，所以只能先写30分，写完并没有样例给我测。</p>
<p>看了看T4发现有 <span class="math inline">\(n=3\)</span> 的20分傻逼分可以拿，写完过不了样例才发现1减3比2大应该输出1，感谢样例。</p>
<p>至此2h已过只拿了150分，感觉这样下去不太行于是赶紧去看T1。</p>
<p>T1感觉 <span class="math inline">\(O(1)\)</span> 的做法非常复杂但是二分年份算儒略日的做法却很简单，看到了1e5的数据范围毫不犹豫的选择二分。具体来说需要分1582年前和1582年后分类讨论闰年，把负年份全体+1可以省掉很多分类讨论，只需要输出的时候减回去就行。1h左右写完过了前两个样例就放到一边了。</p>
<p>造了一下T1的极限数据发现跑的很快，然后又造了T2的极限数据，数据生成器却RE了，gdb给了一个从没见过的报错，尝试多次无果只能放弃。</p>
<p>大约还剩40min，T3感觉有思路而T4想不到什么能拿40的指数级做法，而且切掉T3能多拿70，果断开T3。</p>
<p>手画了几张小DAG发现只需要处理两个影响：后面操作中的乘对前面操作中的加的影响、3操作中后面出边中的乘对前面出边中的加的影响。所以先对反图跑一边拓扑排序求出每个点后继所有的乘，然后把询问倒序算上后面询问的影响后在图中打上标记，最后对原图跑一遍拓扑排序推标记，推的时候注意算上3操作顺序的影响，最后把所有加操作上的标记做完即可。时间复杂度 <span class="math inline">\(O(n+m+Q+\sum C_i)\)</span>。</p>
<p>想完只剩30min，抓紧时间码码码终于在结束前10min过了两个小样例，感觉测大样例也来不及改了就把文件输入输出打上，把万能头换掉，粘到个人文件夹里等考试结束。</p>
<p>期望得分：100+100+100+20=320</p>
<p><strong>11.16 Update</strong></p>
<p>T1没判1582年删掉的十天挂了20（感谢良心出题人让我只挂了20），T3数据分治挂了20，最终得分280，山东省现役rank5。</p>
<p>整体来说还是把水平发挥出来了，但T3数据分治挂分实在不应该，T1也没有顾及到细节，还是有些遗憾的。</p>
<p>吸取教训，待到NOIP再战！</p>
]]></content>
      <categories>
        <category>游记</category>
      </categories>
      <tags>
        <tag>CSP 游记</tag>
      </tags>
  </entry>
  <entry>
    <title>避免实数二分的精度误差</title>
    <url>/2020/11/04/%E9%81%BF%E5%85%8D%E5%AE%9E%E6%95%B0%E4%BA%8C%E5%88%86%E7%9A%84%E7%B2%BE%E5%BA%A6%E8%AF%AF%E5%B7%AE/</url>
    <content><![CDATA[<p>避免实数二分的精度误差。</p>
<a id="more"></a>
<p>有这样一类题目，需要二分答案求解，要求四舍五入保留几位小数输出。</p>
<p><strong>（以下均假设题目要求保留4位小数）</strong></p>
<p>二分答案时，通常认为当 <span class="math inline">\(l\)</span> 和 <span class="math inline">\(r\)</span> 相差极小时答案正确，但是当答案刚好在舍入边界时仍有可能使答案错误。</p>
<p>例如 <span class="math inline">\(l,r\)</span> 分别为 <span class="math inline">\(0.0000495\)</span> 和 <span class="math inline">\(0.0000505\)</span>，满足 <span class="math inline">\(r-l\le10^{-6}\)</span>，当答案为 <span class="math inline">\(0.0000499\)</span> 时输出 <span class="math inline">\(r\)</span> 会导致答案错，同理当答案为 <span class="math inline">\(0.0000500\)</span> 时输出 <span class="math inline">\(l\)</span> 也会导致答案错误。</p>
<p>那么怎么避免呢？</p>
<h3 id="法1">法1</h3>
<p>显然 <span class="math inline">\(l\)</span> 和 <span class="math inline">\(r\)</span> 的差值越小，随机数据的正确率越高。</p>
<p>当 <span class="math inline">\(r-l\le10^{-6}\)</span> 时，答案在 <code>(0.xxxx49,0.xxxx50)</code> 即可卡掉输出 <span class="math inline">\(r\)</span>，在 <code>[0.xxxx50,0.xxxx51)</code> 即可卡掉输出 <span class="math inline">\(l\)</span>，随机数据下错误的概率约为 <span class="math inline">\(\frac{10^{-6}}{10^{-4}}=1\%\)</span></p>
<p>但是当 <span class="math inline">\(r-l\le10^{-12}\)</span> 时，答案需要在 <code>(0.xxxx49999999,0.xxxx50000000)</code> 才能卡掉输出 <span class="math inline">\(r\)</span>，在 <code>[0.xxxx50000000,0.xxxx50000001)</code> 才能卡掉输出 <span class="math inline">\(l\)</span>，随机数据下错误的概率仅约为 <span class="math inline">\(\frac{10^{-12}}{10^{-4}}=0.000001\%\)</span></p>
<p>所以需要尽可能的减小 <span class="math inline">\(l\)</span> 和 <span class="math inline">\(r\)</span> 的差值来增加正确率，可以 <code>while(round(l*1e4)!=round(r*1e4))</code> 配合卡时使用。</p>
<p><strong>注：此法需要出题人父母健在！</strong></p>
<h3 id="法2">法2</h3>
<p>如果在二分答案的过程中把方案存下来，最后输出用方案求得的答案，即可把答案区间变为确定性的一个值。</p>
<p>但是如果在舍入边界附近有两个极为接近的答案，仍有可能使答案错误。</p>
<p>例如一种方案的答案为 <span class="math inline">\(0.0000499\)</span>，另一种方案的答案为 <span class="math inline">\(0.0000500\)</span>，此时输出第一种方案的答案会使最大化问题的答案错误，输出第二种方案的答案会使最小化问题的答案错误。</p>
<p>所以仍然需要尽可能的减小 <span class="math inline">\(l\)</span> 和 <span class="math inline">\(r\)</span> 的差值来增加正确率，可以使用卡时来获得最大的正确率。</p>
<p><strong>注：此法仍然需要出题人父母健在！</strong></p>
<h3 id="法3">法3</h3>
<p>在最大化问题中，当 <span class="math inline">\(l\)</span> 的前4位小数和 <span class="math inline">\(r\)</span> 的前4位小数相同时（假设为 <code>xxxx</code>），直接 <code>check(0.xxxx5)</code>，如果通过，则答案区间为 <code>[0.xxxx5,r]</code>，否则答案区间为 <code>(l,0.xxxx5)</code>。</p>
<p>同理在最小化问题中，当 <span class="math inline">\(l\)</span> 和 <span class="math inline">\(r\)</span> 的前4位小数相同时（假设为 <code>xxxx</code>），直接 <code>check(0.xxxx499999999999...)</code>，如果通过，则答案区间为 <code>[l,0.xxxx5)</code>，否则答案区间为 <code>[0.xxxx5,r)</code>。</p>
<p>这种方法的正确性只依赖于计算机的实数精度，几乎避免了四舍五入所带来的精度误差，且常数最优。</p>
<p>一道卡精度题：<a href="https://loj.ac/problem/149">「LOJ 149」01分数规划</a></p>
]]></content>
      <categories>
        <category>考试技巧</category>
      </categories>
      <tags>
        <tag>LibreOJ</tag>
        <tag>实数二分</tag>
        <tag>精度误差</tag>
        <tag>卡时</tag>
      </tags>
  </entry>
  <entry>
    <title>模板汇总</title>
    <url>/2020/11/02/%E6%A8%A1%E6%9D%BF%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<p>OI 模板汇总。</p>
<a id="more"></a>
<p>板子实在太多了，几乎不可能同时记住。不论难易全部汇总一下，定期复习。</p>
<h2 id="数论">数论</h2>
<h3 id="快速幂快速乘">快速幂&amp;快速乘</h3>
<p><span class="math inline">\(a^b=(a^{\lfloor\frac{b}{2}\rfloor})^2\cdot a^{b\bmod2}\)</span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) t=<span class="number">1l</span>l*t*a%mod;</span><br><span class="line">		a=<span class="number">1l</span>l*a*a%mod; b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="math inline">\(a\cdot b=2(a\cdot\lfloor\frac{b}{2}\rfloor)+a\cdot(b\bmod2)\)</span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(ll &amp;a,ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll t=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>) inc(t,a);</span><br><span class="line">		inc(a&lt;&lt;<span class="number">1</span>,<span class="number">0</span>); b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注：在部分编译器上 <code>long double</code> 的有效位数只有65位，此时用 <code>long double</code> 做快速乘可能会炸精度，所以还是一个 <span class="math inline">\(\log\)</span> 的快速乘更加稳妥。</strong></p>
<h3 id="扩展欧几里得">扩展欧几里得</h3>
<p>求一组特解 <span class="math inline">\(x,y\)</span> 使得 <span class="math inline">\(ax+by=\gcd(a,b)\)</span>。</p>
<p><span class="math display">\[\begin{align*}\gcd(a,b)&amp;=\gcd(b,a\bmod b)\\ax+by&amp;=bx&#39;+(a\bmod b)y&#39;\\ax+by&amp;=bx&#39;+(a-\lfloor\frac{a}{b}\rfloor b)y&#39;\\ax+by&amp;=ay&#39;+b(x&#39;-\lfloor\frac{a}{b}\rfloor y&#39;)\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}\therefore x=y&#39;,y=(x&#39;-\lfloor\frac{a}{b}\rfloor y&#39;)\end{align*}\]</span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y,<span class="keyword">int</span> &amp;g)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		x=<span class="number">1</span>; y=<span class="number">0</span>; g=a; <span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	exgcd(b,a%b,y,x,g);</span><br><span class="line">	y-=a/b*x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="裴蜀定理">裴蜀定理</h3>
<p>关于整数 <span class="math inline">\(x,y\)</span> 的二元一次不定方程 <span class="math inline">\(ax+by=c\)</span> 有解的充分必要条件为 <span class="math inline">\(\gcd(a,b)|c\)</span>。</p>
<p>若 <span class="math inline">\(x_0,y_0\)</span> 为 <span class="math inline">\(ax+by=\gcd(a,b)\)</span> 的一组特解，则有：</p>
<p><span class="math display">\[\begin{align*}ax_0+by_0&amp;=\gcd(a,b)\\a\frac{x_0c}{gcd(a,b)}+b\frac{y_0c}{gcd(a,b)}&amp;=c\end{align*}\]</span></p>
<p><span class="math inline">\(\therefore\)</span> 原方程的一组特解为：</p>
<p><span class="math display">\[\begin{align*}x_1=\frac{x_0c}{\gcd(a,b)},y1=\frac{y_0c}{\gcd(a,b)} \end{align*}\]</span></p>
<p>（待续）</p>
<h3 id="乘法逆元">乘法逆元</h3>
<h3 id="bsgs">BSGS</h3>
<h3 id="扩展bsgs">扩展BSGS</h3>
<h3 id="原根">原根</h3>
<h3 id="二次剩余">二次剩余</h3>
<h3 id="miller-rabin">Miller-Rabin</h3>
<h3 id="pollard-rho">Pollard-Rho</h3>
<h3 id="线性筛">线性筛</h3>
<h3 id="狄利克雷卷积">狄利克雷卷积</h3>
<h3 id="莫比乌斯反演">莫比乌斯反演</h3>
<h3 id="杜教筛">杜教筛</h3>
<h3 id="min_25筛">min_25筛</h3>
<h3 id="线性基">线性基</h3>
<h2 id="多项式">多项式</h2>
<h3 id="fft">FFT</h3>
<p>预处理单位根要注意必须全部用三角函数计算，不能从前一个推过来，精度更高。</p>
<p>三次变两次：由于 <span class="math inline">\((A+Bi)(A+Bi)=A^2-B^2+2ABi\)</span>，所以把两个多项式分别放在实部和虚部上，自己乘自己，最后虚部除以2就是答案。这样做虽然获得了一个 <span class="math inline">\(\frac{2}{3}\)</span> 的常数，但是精度不如原来高，需要谨慎使用（<span class="math inline">\(10^7\)</span> 内一位数系数的多项式相乘没有问题）。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> Pool[(<span class="number">1</span>&lt;&lt;<span class="number">26</span>)+<span class="number">5</span>];</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span>* <span class="keyword">operator</span> <span class="keyword">new</span>[] (<span class="keyword">size_t</span> size)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> *p=Pool;</span><br><span class="line">	p+=size; <span class="keyword">return</span> p-size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi=<span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K=<span class="number">21</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=(<span class="number">1</span>&lt;&lt;<span class="number">21</span>)+<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">double</span> x,y;</span><br><span class="line">	Complex() &#123;&#125;</span><br><span class="line">	Complex(<span class="keyword">double</span> x_,<span class="keyword">double</span> y_): x(x_),y(y_) &#123;&#125;</span><br><span class="line">	<span class="keyword">inline</span> Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex &amp;rhs) <span class="keyword">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> Complex(x+rhs.x,y+rhs.y);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">inline</span> Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex &amp;rhs) <span class="keyword">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> Complex(x-rhs.x,y-rhs.y);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">inline</span> Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex &amp;rhs) <span class="keyword">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> Complex(x*rhs.x-y*rhs.y,x*rhs.y+y*rhs.x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span> += (<span class="keyword">const</span> Complex &amp;rhs)</span><br><span class="line">	&#123;</span><br><span class="line">		*<span class="keyword">this</span>=*<span class="keyword">this</span>+rhs;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span> -= (<span class="keyword">const</span> Complex &amp;rhs)</span><br><span class="line">	&#123;</span><br><span class="line">		*<span class="keyword">this</span>=*<span class="keyword">this</span>-rhs;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">void</span> <span class="keyword">operator</span> *= (<span class="keyword">const</span> Complex &amp;rhs)</span><br><span class="line">	&#123;</span><br><span class="line">		*<span class="keyword">this</span>=*<span class="keyword">this</span>*rhs;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> rv[N];</span><br><span class="line">Complex *wn[<span class="number">2</span>][K],F[N],G[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PolyInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=K;++k)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> len=(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>));</span><br><span class="line">		wn[<span class="number">0</span>][k<span class="number">-1</span>]=<span class="keyword">new</span> Complex[len];</span><br><span class="line">		wn[<span class="number">1</span>][k<span class="number">-1</span>]=<span class="keyword">new</span> Complex[len];</span><br><span class="line">		Complex *ptr=wn[<span class="number">0</span>][k<span class="number">-1</span>];</span><br><span class="line">		Complex *ptri=wn[<span class="number">1</span>][k<span class="number">-1</span>];</span><br><span class="line">		ptr[<span class="number">0</span>]=ptri[<span class="number">0</span>]=Complex(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len;++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">double</span> x=<span class="built_in">cos</span>(<span class="number">2</span>*Pi/(<span class="number">1</span>&lt;&lt;k)*i);</span><br><span class="line">			<span class="keyword">double</span> y=<span class="built_in">sin</span>(<span class="number">2</span>*Pi/(<span class="number">1</span>&lt;&lt;k)*i);</span><br><span class="line">			ptr[i]=Complex(x,y);</span><br><span class="line">			ptri[i]=Complex(x,-y);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(Complex *F,<span class="keyword">int</span> n,<span class="keyword">bool</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(rv[i]&gt;i) swap(F[i],F[rv[i]]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;k)&lt;=n;++k)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> len=(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>));</span><br><span class="line">		Complex *ptr=wn[op][k<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i+=(<span class="number">1</span>&lt;&lt;k))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">0</span>;l&lt;len;++l)</span><br><span class="line">			&#123;</span><br><span class="line">				Complex tmp=ptr[l]*F[i+len+l];</span><br><span class="line">				F[i+len+l]=F[i+l]-tmp;</span><br><span class="line">				F[i+l]+=tmp;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PolyMul</span><span class="params">(Complex *F,<span class="keyword">int</span> n1,Complex *G,<span class="keyword">int</span> n2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n=<span class="number">1</span>,l=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(n&lt;=n1+n2) n&lt;&lt;=<span class="number">1</span>,++l;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		rv[i]=(rv[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	FFT(F,n,<span class="number">0</span>);</span><br><span class="line">	FFT(G,n,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) F[i]*=G[i];</span><br><span class="line">	FFT(F,n,<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n1+n2;++i) F[i].x/=n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ntt">NTT</h3>
<h3 id="任意模数ntt">任意模数NTT</h3>
<h3 id="求导积分">求导&amp;积分</h3>
<h3 id="泰勒展开">泰勒展开</h3>
<h3 id="牛顿迭代">牛顿迭代</h3>
<h3 id="多项式求逆">多项式求逆</h3>
<h3 id="多项式ln">多项式Ln</h3>
<h3 id="多项式exp">多项式Exp</h3>
<h3 id="多项式开根">多项式开根</h3>
<h3 id="多项式快速幂">多项式快速幂</h3>
<h3 id="多项式带余除法">多项式带余除法</h3>
<h3 id="多项式多点求值">多项式多点求值</h3>
<h3 id="多项式快速插值">多项式快速插值</h3>
<h2 id="生成函数">生成函数</h2>
<h3 id="普通生成函数">普通生成函数</h3>
<h3 id="指数型生成函数">指数型生成函数</h3>
<h3 id="burnside引理">Burnside引理</h3>
<h2 id="组合数学">组合数学</h2>
<h3 id="lucas定理">Lucas定理</h3>
<h3 id="扩展lucas定理">扩展Lucas定理</h3>
<h3 id="组合恒等式">组合恒等式</h3>
<h3 id="第二类斯特林数">第二类斯特林数</h3>
<h3 id="第一类斯特林数">第一类斯特林数</h3>
<h2 id="数据结构">数据结构</h2>
<h3 id="并查集">并查集</h3>
<h3 id="hash表">Hash表</h3>
<h3 id="树状数组">树状数组</h3>
<h3 id="线段树">线段树</h3>
<h3 id="非递归线段树">非递归线段树</h3>
<h3 id="李超树">李超树</h3>
<h3 id="吉老师线段树">吉老师线段树</h3>
<h3 id="左偏树">左偏树</h3>
<h3 id="kd-tree">KD Tree</h3>
<h3 id="块状链表">块状链表</h3>
<h3 id="splay">Splay</h3>
<p>手写 <code>set</code>。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> a[N],tot,f[M],ch[M][<span class="number">2</span>],v[M],c[M],s[M];</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rt ch[0][1]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> chk(x) (ch[f[x]][1]==x)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	s[x]=s[ch[x][<span class="number">0</span>]]+s[ch[x][<span class="number">1</span>]]+c[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">connect</span><span class="params">(<span class="keyword">int</span> fa,<span class="keyword">int</span> k,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	f[x]=fa; ch[fa][k]=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> y=f[x],z=f[y],k=chk(x);</span><br><span class="line">	connect(y,k,ch[x][k^<span class="number">1</span>]);</span><br><span class="line">	connect(z,chk(y),x);</span><br><span class="line">	connect(x,k^<span class="number">1</span>,y);</span><br><span class="line">	pushup(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(f[x])</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> y=f[x];</span><br><span class="line">		<span class="keyword">if</span>(f[y]) rotate(chk(x)==chk(y)?y:x);</span><br><span class="line">		rotate(x);</span><br><span class="line">	&#125;</span><br><span class="line">	pushup(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> fa,<span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	++tot; f[tot]=fa; v[tot]=val; c[tot]=<span class="number">1</span>; s[tot]=<span class="number">1</span>; <span class="keyword">return</span> tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> fa,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> x=newnode(fa,a[mid]);</span><br><span class="line">	ch[x][<span class="number">0</span>]=build(x,l,mid<span class="number">-1</span>);</span><br><span class="line">	ch[x][<span class="number">1</span>]=build(x,mid+<span class="number">1</span>,r);</span><br><span class="line">	pushup(x);</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!rt)</span><br><span class="line">	&#123;</span><br><span class="line">		rt=newnode(<span class="number">0</span>,val); <span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> x=rt;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(v[x]==val)</span><br><span class="line">		&#123;</span><br><span class="line">			++c[x]; splay(x); <span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> k=(val&gt;v[x]);</span><br><span class="line">		<span class="keyword">if</span>(!ch[x][k])</span><br><span class="line">		&#123;</span><br><span class="line">			ch[x][k]=newnode(x,val);</span><br><span class="line">			splay(ch[x][k]); <span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		x=ch[x][k];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">erase</span><span class="params">(<span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x=rt;</span><br><span class="line">	<span class="keyword">while</span>(v[x]!=val) x=ch[x][val&gt;v[x]];</span><br><span class="line">	splay(x);</span><br><span class="line">	<span class="keyword">if</span>(c[x]&gt;<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		--c[x]; --s[x]; <span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(!ch[x][<span class="number">0</span>]||!ch[x][<span class="number">1</span>])</span><br><span class="line">	&#123;</span><br><span class="line">		connect(<span class="number">0</span>,<span class="number">1</span>,ch[x][<span class="number">0</span>]|ch[x][<span class="number">1</span>]); <span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> lef=ch[x][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">while</span>(ch[lef][<span class="number">1</span>]) lef=ch[lef][<span class="number">1</span>];</span><br><span class="line">	splay(lef);</span><br><span class="line">	connect(rt,<span class="number">1</span>,ch[x][<span class="number">1</span>]);</span><br><span class="line">	pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rank</span><span class="params">(<span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x=rt,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(v[x]==val)</span><br><span class="line">		&#123;</span><br><span class="line">			splay(x); <span class="keyword">return</span> s[ch[x][<span class="number">0</span>]]+<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> k=(val&gt;v[x]);</span><br><span class="line">		<span class="keyword">if</span>(k==<span class="number">1</span>) sum+=s[ch[x][<span class="number">0</span>]]+c[x];</span><br><span class="line">		<span class="keyword">if</span>(!ch[x][k])</span><br><span class="line">		&#123;</span><br><span class="line">			splay(x); <span class="keyword">return</span> sum+<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		x=ch[x][k];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">kth</span><span class="params">(<span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x=rt;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> tmp=s[ch[x][<span class="number">0</span>]]+c[x];</span><br><span class="line">		<span class="keyword">if</span>(k&gt;tmp) k-=tmp,x=ch[x][<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(k&lt;=s[ch[x][<span class="number">0</span>]]) x=ch[x][<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			splay(x); <span class="keyword">return</span> v[x];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pre</span><span class="params">(<span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	insert(val);</span><br><span class="line">	<span class="keyword">int</span> lef=ch[rt][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">while</span>(ch[lef][<span class="number">1</span>]) lef=ch[lef][<span class="number">1</span>];</span><br><span class="line">	splay(lef);</span><br><span class="line">	<span class="keyword">int</span> rig=ch[rt][<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">if</span>(c[rig]&gt;<span class="number">1</span>) --c[rig],--s[rig];</span><br><span class="line">	<span class="keyword">else</span> connect(rt,<span class="number">1</span>,ch[rig][<span class="number">1</span>]);</span><br><span class="line">	pushup(rt);</span><br><span class="line">	<span class="keyword">return</span> v[rt];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">suc</span><span class="params">(<span class="keyword">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	insert(val);</span><br><span class="line">	<span class="keyword">int</span> rig=ch[rt][<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">while</span>(ch[rig][<span class="number">0</span>]) rig=ch[rig][<span class="number">0</span>];</span><br><span class="line">	splay(rig);</span><br><span class="line">	<span class="keyword">int</span> lef=ch[rt][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">if</span>(c[lef]&gt;<span class="number">1</span>) --c[lef],--s[lef];</span><br><span class="line">	<span class="keyword">else</span> connect(rt,<span class="number">0</span>,ch[lef][<span class="number">0</span>]);</span><br><span class="line">	pushup(rt);</span><br><span class="line">	<span class="keyword">return</span> v[rt];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="非旋treap">非旋Treap</h3>
<h3 id="lct">LCT</h3>
<h3 id="aaa树">AAA树</h3>
<h3 id="可持久化">可持久化</h3>
<h2 id="图论">图论</h2>
<h3 id="最小生成树">最小生成树</h3>
<h3 id="最短路">最短路</h3>
<h3 id="lca">LCA</h3>
<h3 id="强连通分量">强连通分量</h3>
<h3 id="边双">边双</h3>
<h3 id="点双">点双</h3>
<h3 id="圆方树">圆方树</h3>
<h3 id="点分治">点分治</h3>
<h3 id="点分树">点分树</h3>
<h3 id="匈牙利">匈牙利</h3>
<h3 id="带花树">带花树</h3>
<h3 id="最大流">最大流</h3>
<h3 id="费用流">费用流</h3>
<h3 id="上下界网络流">上下界网络流</h3>
<h3 id="循环流">循环流</h3>
<h2 id="高精度">高精度</h2>
<h3 id="int128">int128</h3>
<h3 id="高精加">高精加</h3>
<h3 id="高精减">高精减</h3>
<h3 id="高精乘">高精乘</h3>
<h3 id="高精度带余除法">高精度带余除法</h3>
<h3 id="高精度开根">高精度开根</h3>
<h2 id="字符串">字符串</h2>
<h3 id="hash">Hash</h3>
<h3 id="manacher">Manacher</h3>
<h3 id="kmp">KMP</h3>
<h3 id="ac自动机">AC自动机</h3>
<h3 id="后缀数组">后缀数组</h3>
<h3 id="后缀自动机">后缀自动机</h3>
<h3 id="回文自动机">回文自动机</h3>
<h3 id="子序列自动机">子序列自动机</h3>
<h2 id="计算几何">计算几何</h2>
<h3 id="向量基本运算">向量基本运算</h3>
<h3 id="凸多变形面积">凸多变形面积</h3>
<h3 id="二维凸包">二维凸包</h3>
<h3 id="半平面交">半平面交</h3>
<h3 id="旋转卡壳">旋转卡壳</h3>
<h3 id="最小圆覆盖">最小圆覆盖</h3>
<h2 id="随机化算法">随机化算法</h2>
<h3 id="模拟退火">模拟退火</h3>
<h2 id="考试技巧">考试技巧</h2>
<h3 id="io">IO</h3>
<h3 id="卡时">卡时</h3>
]]></content>
      <categories>
        <category>模板</category>
      </categories>
      <tags>
        <tag>模板</tag>
      </tags>
  </entry>
  <entry>
    <title>「CQOI2014」数三角形</title>
    <url>/2020/11/01/CQOI2014-%E6%95%B0%E4%B8%89%E8%A7%92%E5%BD%A2/</url>
    <content><![CDATA[<p>思维题。</p>
<a id="more"></a>
<blockquote>
<p>题目链接：<a href="https://darkbzoj.tk/problem/3505">「BZOJ 3505」</a> <a href="https://loj.ac/problem/2240">「LibreOJ 2240」</a> <a href="https://www.luogu.com.cn/problem/P3166">「Luogu 3166」</a></p>
</blockquote>
<h4 id="题意">题意</h4>
<p>求 <span class="math inline">\(n\times m\)</span> 的网格中，有多少三角形三个点都在个点上，<span class="math inline">\(n，m\le1000\)</span>。</p>
<figure>
<img src="https://ooo.0o0.ooo/2017/05/03/59091867eebda.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<p>图为一个 <span class="math inline">\(4\times4\)</span> 的网格。</p>
<h4 id="题解">题解</h4>
<p>直接求不好求，考虑用总的三角形数量减去共线的三角形数量。</p>
<p>横线数量：<span class="math inline">\(C_{m+1}^3(n+1)\)</span></p>
<p>竖线数量：<span class="math inline">\(C_{n+1}^3(m+1)\)</span></p>
<p>斜线数量：枚举矩形，将（矩形对角线两端点和对角线上一点组成的三角形数量*矩形数量）贡献到答案里。设矩形的长、高分别为 <span class="math inline">\(x\)</span>、<span class="math inline">\(y\)</span>，矩形对角线上不含端点的整点数量为 <span class="math inline">\(\gcd(x,y)-1\)</span>，矩形数量为 <span class="math inline">\((n-x+1)(m-y+1)\)</span>。因为这样相当于枚举了共线三点的外面两点，所以不会算重或算漏。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">C3</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1l</span>l*n*(n<span class="number">-1</span>)*(n<span class="number">-2</span>)/<span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!b) <span class="keyword">return</span> a;</span><br><span class="line">	<span class="keyword">return</span> gcd(b,a%b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n,m;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">	ll ans=C3((n+<span class="number">1</span>)*(m+<span class="number">1</span>))-C3(n+<span class="number">1</span>)*(m+<span class="number">1</span>)-C3(m+<span class="number">1</span>)*(n+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</span><br><span class="line">			ans-=<span class="number">2l</span>l*(gcd(i,j)<span class="number">-1</span>)*(n-i+<span class="number">1</span>)*(m-j+<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>题解</category>
      </categories>
      <tags>
        <tag>CQOI</tag>
        <tag>组合数</tag>
        <tag>思维题</tag>
        <tag>BZOJ</tag>
        <tag>LibreOJ</tag>
        <tag>Luogu</tag>
      </tags>
  </entry>
  <entry>
    <title>「NOI2014」动物园</title>
    <url>/2020/11/01/NOI2014-%E5%8A%A8%E7%89%A9%E5%9B%AD/</url>
    <content><![CDATA[<p>KMP。</p>
<a id="more"></a>
<blockquote>
<p>题目链接：<a href="https://uoj.ac/problem/5">「UOJ 5」</a> <a href="https://darkbzoj.tk/problem/3670">「BZOJ 3670」</a> <a href="https://loj.ac/problem/2246">「LibreOJ 2246」</a> <a href="https://www.luogu.com.cn/problem/P2375">「Luogu 2375」</a></p>
</blockquote>
<h4 id="题意">题意</h4>
<p>求给定字符串 <span class="math inline">\(S\)</span> 的每一个前缀的不重叠border数量，<span class="math inline">\(|S|\le10^6\)</span>。</p>
<h4 id="题解">题解</h4>
<p>一道KMP好题。</p>
<p>暴力：不断跳border，直到长度小于等于 <span class="math inline">\(\frac{i}{2}\)</span>，该border的border数量+1即为 <code>num[i]</code>，时间复杂度 <span class="math inline">\(O(n^2)\)</span>。</p>
<p>用倍增优化跳border，在 <span class="math inline">\(O(\log i)\)</span> 的时间内即可跳到长度小于等于 <span class="math inline">\(\frac{i}{2}\)</span> 的最长border，时间复杂度 <span class="math inline">\(O(n\log n)\)</span>。将小的一维放到前面可以有效优化常数。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> nxt[K][N],lg[N],sum[N];<span class="comment">//log那一维放前面更快 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KMP</span><span class="params">(<span class="keyword">char</span> *s,<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span>(j!=<span class="number">0</span>&amp;&amp;s[j+<span class="number">1</span>]!=s[i]) j=nxt[<span class="number">0</span>][j];</span><br><span class="line">		<span class="keyword">if</span>(s[j+<span class="number">1</span>]==s[i]) ++j;</span><br><span class="line">		nxt[<span class="number">0</span>][i]=j;</span><br><span class="line"><span class="comment">//		for(int k=1;nxt[k-1][i];++k)//注意多组数据要清空 </span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=lg[i];++k)</span><br><span class="line">			nxt[k][i]=nxt[k<span class="number">-1</span>][nxt[k<span class="number">-1</span>][i]];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;t);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=<span class="number">1000000</span>;++i) lg[i]=lg[i&gt;&gt;<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(t--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">int</span> n=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">		KMP(s,n);</span><br><span class="line">		<span class="keyword">int</span> ans=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> x=i;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=lg[i];j&gt;=<span class="number">0</span>;--j)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="number">2</span>*nxt[j][x]&gt;i) x=nxt[j][x];</span><br><span class="line">			&#125;</span><br><span class="line">			x=nxt[<span class="number">0</span>][x];</span><br><span class="line">			ans=<span class="number">1l</span>l*ans*(sum[x]+<span class="number">1</span>)%mod;</span><br><span class="line">			sum[i]=sum[nxt[<span class="number">0</span>][i]]+<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类比于KMP求next数组的过程，考虑在 <span class="math inline">\(S_{1... i-1}\)</span> 的不重叠border后面接上 <span class="math inline">\(S_i\)</span> 得到 <span class="math inline">\(S_{1...i}\)</span> 的最长不重叠border。</p>
<p>因为 <span class="math inline">\(S_{1...i}\)</span> 的border全部由 <span class="math inline">\(S_{1...i-1}\)</span> 的border后面接一个字符得到，所以 <span class="math inline">\(S_{1...i}\)</span> 的不重叠border长度一定小于等于 <span class="math inline">\(S_{1...i-1}\)</span> 的最长不重叠border长度+1。</p>
<p>时间复杂度 <span class="math inline">\(O(n)\)</span>。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> nxt[N],sum[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KMP</span><span class="params">(<span class="keyword">char</span> *s,<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> j=<span class="number">0</span>; sum[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span>(j&amp;&amp;s[j+<span class="number">1</span>]!=s[i]) j=nxt[j];</span><br><span class="line">		<span class="keyword">if</span>(s[j+<span class="number">1</span>]==s[i]) ++j;</span><br><span class="line">		nxt[i]=j; sum[i]=sum[j]+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;t);</span><br><span class="line">	<span class="keyword">while</span>(t--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">int</span> n=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">		KMP(s,n);</span><br><span class="line">		<span class="keyword">int</span> j=<span class="number">0</span>,ans=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span>(j&amp;&amp;s[j+<span class="number">1</span>]!=s[i]) j=nxt[j];</span><br><span class="line">			<span class="keyword">if</span>(s[j+<span class="number">1</span>]==s[i]) ++j;</span><br><span class="line">			<span class="keyword">if</span>(<span class="number">2</span>*j&gt;i) j=nxt[j];</span><br><span class="line">			ans=<span class="number">1l</span>l*ans*(sum[j]+<span class="number">1</span>)%mod;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>题解</category>
      </categories>
      <tags>
        <tag>BZOJ</tag>
        <tag>LibreOJ</tag>
        <tag>Luogu</tag>
        <tag>NOI</tag>
        <tag>KMP</tag>
        <tag>倍增</tag>
        <tag>UOJ</tag>
      </tags>
  </entry>
  <entry>
    <title>大事记</title>
    <url>/2020/10/30/%E5%A4%A7%E4%BA%8B%E8%AE%B0/</url>
    <content><![CDATA[<p>大事记。</p>
<a id="more"></a>
<h5 id="section">2017.07~11</h5>
<p>学习枚举、冒泡排序、贪心、高精度、进制转换、搜索。</p>
<h5 id="section-1">2017.11.11</h5>
<p>NOIP普及组125分，山东省二。</p>
<h5 id="section-2">2017.12.18</h5>
<p>学习线性筛。</p>
<h5 id="section-3">2018.03.24</h5>
<p>学习快速排序。</p>
<h5 id="section-4">2018.03.31</h5>
<p>学习01背包。</p>
<h5 id="section-5">2018.06.30</h5>
<p>学习多重背包、完全背包。</p>
<h5 id="section-6">2018.07.01</h5>
<p>学习二进制优化。</p>
<h5 id="section-7">2018.07.03</h5>
<p>学习最长上升子序列。</p>
<h5 id="section-8">2018.07.06</h5>
<p>学习并查集。</p>
<h5 id="section-9">2018.07.07</h5>
<p>学习分组背包。</p>
<h5 id="section-10">2018.07.15</h5>
<p>学习单调队列。</p>
<h5 id="section-11">2018.07.18</h5>
<p>学习Floyd、Dijkstra。</p>
<h5 id="section-12">2018.07.19</h5>
<p>学习链式前向星、Bellman-Ford。</p>
<h5 id="section-13">2018.07.20</h5>
<p>学习SPFA</p>
<h5 id="section-14">2018.07.25</h5>
<p>学习Kruskal最小生成树。</p>
<h5 id="section-15">2018.07.28</h5>
<p>学习树状数组、差分与前缀和。</p>
<h5 id="section-16">2018.08.04</h5>
<p>学习区间dp。</p>
<h5 id="section-17">2018.08.06</h5>
<p>学习Dijkstra的堆优化。</p>
<h5 id="section-18">2018.10.20</h5>
<p>学习二分答案。</p>
<h5 id="section-19">2018.11.10</h5>
<p>NOIP普及组176分，山东省一。</p>
<h5 id="section-20">2019.03.31</h5>
<p>学习线段树。</p>
<h5 id="section-21">2019.06.21</h5>
<p>学习倍增LCA。</p>
<h5 id="section-22">2019.06.27</h5>
<p>学习重链剖分。</p>
<h5 id="section-23">2019.08.03</h5>
<p>学习ST表。</p>
<h5 id="section-24">2019.08.06~12</h5>
<p>参加清北学堂提高组腾飞营，学习分治、归并排序、自然溢出Hash、并查集安置合并、Prim最小生成树、Tarjan强连通分量、拓扑排序、欧拉回路、差分约束。</p>
<h5 id="section-25">2019.08.16~22</h5>
<p>参加清北学堂解题能力特训营，学习树形dp、状压dp、数位dp、乘法逆元、扩展欧几里得，dp基本入门。</p>
<h5 id="section-26">2019.09.22</h5>
<p>学习可持久化线段树。</p>
<h5 id="section-27">2019.09.27</h5>
<p>学习匈牙利算法。</p>
<h5 id="section-28">2019.10.01~06</h5>
<p>参加正睿国庆联赛冲刺，学习矩阵快速幂、树剖LCA、欧拉序RMQLCA、线段树合并。</p>
<h5 id="section-29">2019.10.12</h5>
<p>学习Tarjan点双联通分量。</p>
<h5 id="周末">2019.10.19~11.06周末</h5>
<p>参加实验舱线上模拟赛。</p>
<h5 id="section-30">2019.10.22</h5>
<p>学习二维树状数组。</p>
<h5 id="section-31">2019.11.16~17</h5>
<p>CSP-S2 176分，山东省二。</p>
<h5 id="section-32">2019.11.26</h5>
<p>学习最大流、最小费用最大流。</p>
<h5 id="section-33">2019.12.04</h5>
<p>学习Splay。</p>
<h5 id="section-34">2019.12.12</h5>
<p>学习Splay启发式合并、LCT。</p>
<h5 id="section-35">2019.12.30</h5>
<p>学习CDQ分治。</p>
<h5 id="section-36">2020.01.09</h5>
<p>学习AC自动机。</p>
<h5 id="section-37">2020.01.14</h5>
<p>学习左偏树。</p>
<h5 id="section-38">2020.01.16~22</h5>
<p>参加清北学堂省选暨NOI金牌预备营，学习三分、上下界网络流、中国剩余定理、BSGS、原根、二次剩余、FFT、NTT、双模Hash。</p>
<h5 id="section-39">2020.01.17</h5>
<p>学习裴蜀定理。</p>
<h5 id="section-40">2020.02.05</h5>
<p>学习高斯消元。</p>
<h5 id="section-41">2019.02.06</h5>
<p>学习二维凸包。</p>
<h5 id="section-42">2020.02.20</h5>
<p>学习斜率优化。</p>
<h5 id="section-43">2020.03.03</h5>
<p>学习拉格朗日插值。</p>
<h5 id="section-44">2020.03.05</h5>
<p>学习Johnson、扫描线。</p>
<h5 id="周末-1">2020.03.08~22周末</h5>
<p>参加清北学堂NOIP数学专题精讲营，学习Miller_Rabin。</p>
<h5 id="section-45">2020.03.19</h5>
<p>学习矩阵求逆。</p>
<h5 id="section-46">2020.03.21</h5>
<p>学习Lucas定理。</p>
<h5 id="section-47">2020.03.22</h5>
<p>学习多项式乘法逆。</p>
<h5 id="section-48">2020.03.25</h5>
<p>学习多项式Ln。</p>
<h5 id="section-49">2020.04.27</h5>
<p>学习线段树分裂。</p>
<h5 id="section-50">2020.05.01~10</h5>
<p>参加清北学堂省选冲刺营，学习模拟退火。</p>
<h5 id="section-51">2020.05.20</h5>
<p>学习扩展欧拉定理。</p>
<h5 id="section-52">2020.05.23</h5>
<p>学习分治决策单调性优化。</p>
<h5 id="section-53">2020.05.30</h5>
<p>学习莫队。</p>
<h5 id="section-54">2020.06.01</h5>
<p>学习带修莫队。</p>
<h5 id="section-55">2020.06.09</h5>
<p>学习AAA树。</p>
<h5 id="section-56">2020.06.28</h5>
<p>学习点分治。</p>
<h5 id="section-57">2020.07.30</h5>
<p>学习扩展中国剩余定理。</p>
<h5 id="section-58">2020.08.05~14</h5>
<p>参加实验舱CT02，学习十字链表、2-SAT、同余最短路、线段树分治、C++指针。</p>
<h5 id="section-59">2020.08.15~24</h5>
<p>参加实验舱ST03，学习Hash表、KMP、manacher、任意模数NTT、后缀数组、后缀自动机。</p>
<h5 id="section-60">2020.09.04</h5>
<p>学习分治FFT。</p>
<h5 id="section-61">2020.09.09</h5>
<p>学习IDDFS。</p>
<h5 id="section-62">2020.09.14</h5>
<p>学习A*。</p>
<h5 id="section-63">2020.09.14</h5>
<p>学习莫比乌斯反演、杜教筛。</p>
<h5 id="section-64">2020.10.01~08</h5>
<p>参加实验舱ST04，学习群论、卡特兰数、组合数、斯特林数。</p>
<h5 id="section-65">2020.10.19</h5>
<p>出了第一套模拟赛。</p>
<h5 id="section-66">2020.11.07</h5>
<p>CSP-S2 280分，山东rank6。</p>
<h5 id="section-67">2020.11.20</h5>
<p>学习Pollard-Rho。</p>
]]></content>
      <categories>
        <category>大事记</category>
      </categories>
      <tags>
        <tag>大事记</tag>
      </tags>
  </entry>
</search>
